
## کارگزاری

<div class="tab-start">
</div>

# [C#](#tab/csharp)

 کسب‌و‌کار‌ها می‌تواند کسب‌و‌کارهای دیگری را که با آن‌ها همکاری دارند ثبت‌نام کنند. این امکان برای کارگزاران و کسب‌و‌کارهایی که به تسهیم درآمد نیاز دارند بسیار مفید است. همچنین کاربران می‌توانند کسب‌و‌کارها را دنبال کنند، به آن‌ها امتیاز دهند و در مورد آن‌ها نظر دهند تمامی این کارها با استفاده از توابع این ماژول انجام می‌شود. برای اطلاعات بیشتر به لینک [http://docs.pod.land/v1.0.8.0/Developer/Brokerage/683/AddUserAndBusiness](http://docs.pod.land/v1.0.8.0/Developer/Brokerage/683/AddUserAndBusiness) مراجعه کنید.


 **طریقه نصب :** از طریق Package Manager Console و دستورزیر پکیج مربوطه را نصب نمایید. برای دریافت آخرین نسخه پکیج لینک [https://www.nuget.org/packages/POD_Dealing](https://www.nuget.org/packages/POD_Dealing/) چک نمایید.

```csharp
Install-Package POD_Dealing -Version 1.0.1
```


## فراخوانی متدها
 برای فراخونی هریک از متدها, باید یک شی از کلاس DealingService ایجاد کنید. برای استفاده از هر سرویس باید کلاس مربوط به آند سرویس مقداردهی کنید و ازبا استفاده از کلاس DealingService و شی ایجاد شده بعنوان ورودی سرویس مورد نظر,سرویس را اجرا کنید.

```csharp
var dealingService=new DealingService();
```

## ثبت کسب و کار و کاربر
جدید کسب و کار میتواند با استفاده از سرویس زیر، کسب و کارهای دیگری را که با آنها همکاری دارد را ثبت نماید. این امکان برای کارگزاران و کسب و کارهایی که به تسهیم درآمد نیاز دارند بسیار مهم است. با این اقدام، همزمان با ثبت کسب و کار، پنل کاربری نیز ساخته می‌شود. ایمیل کسب و کار و شماره موبایلی که برای او ثبت می شود، برای مواقعی که لازم باشد خود آن کسب و کار در پنل مدیریتی خود وارد شود و برخی اقدامات را بر عهده بگیرد، ضروری است و صاحب کسب و کار میتواند با استفاده از آن رمز عبور خود را تعیین نماید. بنابراین صحت این موارد را کنترل نمایید. سرویس زیر عملیات مهم زیر را در یک عملیات انجام می دهد:

* 	با استفاده از نام کاربری و ایمیل و شماره موبایل که دریافت می کند، امکان ورود به پنل مدیریت کسب و کار برای کسب و کار دیگر فراهم می شود
* 	اطلاعات کسب و کار در پلتفرم (اصلی یا سندباکس) ثبت می شود
* 	یک اپلیکیشن (client) پیشفرض برای کسب و کار به صورت یکپارچه ایجاد می شود. که برای هر دو سرور سندباکس و اصلی اعتبار دارد
* 	بنابراین در صورتی که سرویس زیر را برای مثال در سندباکس فراخوانی نمودید، برای انتقال به سرور اصلی کافیست با همان توکنی که برای کسب و کار از سرور سندباکس دریافت نموده اید، اطلاعات پروفایل کاربر را در سرور اصلی دریافت نموده و یک کسب و کار برای آن کاربر ثبت نمایید.

در پاسخ سرویس بالا اطلاعات کسب و کار همراه با توکن دائمی آن، برگردانده می شود. ضروری است کارگزار توکن را ذخیره و برای اقداماتی که از جانب کسب و کار ثبت شده انجام می دهد استفاده نماید و در حفظ و امنیت آن کوشا باشد.

```csharp
var output = new ResultSrv<BusinessSrv>();
var addUserAndBusinessVo = AddUserAndBusinessVo.ConcreteBuilder
                    .SetToken("{Put your ApiToken}")
                    .SetUsername("{Put your Username}")
                    .SetBusinessName("{Put your BusinessName}")
                    .SetGuildCode({Put your GuildCode})
                    .SetCountry("{Put your Country}")
                    .SetState("{Put your State}")
                    .SetCity("{Put your City}")
                    .SetAddress("{Put your Address}")
                    .SetDescription("{Put your Description}")
                    .SetAgentFirstName("{Put your AgentFirstName}")
                    .SetAgentLastName("{Put your AgentLastName}")
                    .SetEmail("{Put your Email}")
                    //.SetFirstName("{Put your FirstName}")
                    //.SetLastName("{Put your LastName}")
                    //.SetSheba("{Put your Sheba}")
                    //.SetNationalCode("{Put your NationalCode}")
                    //.SetEconomicCode("{Put your EconomicCode}")
                    //.SetRegistrationNumber("{Put your RegistrationNumber}")
                    //.SetCellphone("{Put your Cellphone}")
                    //.SetPhone("{Put your Phone}")
                    //.SetFax("{Put your Fax}")
                    //.SetPostalCode("{Put your PostalCode}")
                    //.SetNewsReader({Put your NewsReader})
                    //.SetLogoImage("{Put your LogoImage}")
                    //.SetCoverImage("{Put your CoverImage}")
                    //.SetTags({Put your Tags}
                    //.SetTagTrees({Put your TagTrees})
                    //.SetTagTreeCategoryName("{Put your TagTreeCategoryName}")
                    //.SetLink("{Put your Link}")
                    //.SetLat({Put your Lat})
                    //.SetLng({Put your Lng})
                    //.SetAgentNationalCode("{Put your AgentNationalCode}")
                    .Build();
dealingService.AddUserAndBusiness(addUserAndBusinessVo, response => Listener.GetResult(response, out output));
```

## جستجو و ویرایش کسب و کارها
 برای دریافت لیست کسب و کارهایی که ایجاد نموده اید کافیست از سرویس زیر استفاده نمایید.

```csharp
var output = new ResultSrv<List<BusinessSrv>>();
 var listUserCreatedBusinessVo = ListUserCreatedBusinessVo.ConcreteBuilder
                    .SetToken("{Put your Token}")
                    //.SetBizId({Put your BizId})
                    //.SetGuildCode({Put your GuildCode})
                    //.SetOffset({Put your Offset})
                    //.SetSize({Put your Size})
                    //.SetQuery("{Put your Query}")
                    //.SetTags({Put your Tags})
                    //.SetTagTrees({Put your TagTrees})
                    //.SetActive({Put your Active})
                    //.SetCountry("{Put your Country}")
                    //.SetState("{Put your State}")
                    //.SetCity("{Put your City}")
                    //.SetSsoId({Put your SsoId})
                    //.SetUsername("{Put your Username}")
                    //.SetBusinessName("{Put your BusinessName}")
                    //.SetSheba("{Put your Sheba}")
                    //.SetNationalCode("{Put your NationalCode}")
                    //.SetEconomicCode("{Put your EconomicCode}")
                    //.SetEmail("{Put your Email}")
                    //.SetCellphone("{Put your Cellphone}")
                    .Build();
dealingService.ListUserCreatedBusiness(listUserCreatedBusinessVo, response => Listener.GetResult(response, out output));
```

## ویرایش کسب و کارها
برای ویرایش کسب و کارهایی که ایجاد نموده اید از سرویس زیر استفاده نمایید.

توجه داشته باشید، بجز موارد اجباری که عدم ثبت آنها منجر به خطا خواهد شد، عدم ارسال سایر موارد منجر به پاک شدن مقدار قبلی می گردد.

```csharp
var output = new ResultSrv<BusinessSrv>();
var updateBusinessVo = UpdateBusinessVo.ConcreteBuilder
                    .SetToken("{Put your Token}")
                    .SetBizId({Put your BizId})
                    .SetBusinessName("{Put your BusinessName}")
                    .SetGuildCode({Put your GuildCode})
                    .SetCountry("{Put your Country}")
                    .SetState("{Put your State}")
                    .SetCity("{Put your City}")
                    .SetAddress("{Put your Address}")
                    .SetDescription("{Put your Description}")
                    //.SetCompanyName("{Put your CompanyName}")
                    //.SetShopName("{Put your ShopName}")
                    //.SetShopNameEn("{Put your ShopNameEn}")
                    //.SetWebsite("{Put your Website}")
                    //.SetDateEstablishing("{Put your DateEstablishing}")
                    //.SetFirstName("{Put your FirstName}")
                    //.SetLastName("{Put your LastName}")
                    //.SetSheba("{Put your Sheba}")
                    //.SetNationalCode("{Put your NationalCode}")
                    //.SetEconomicCode("{Put your EconomicCode}")
                    //.SetRegistrationNumber("{Put your RegistrationNumber}")
                    //.SetEmail("{Put your Email}")
                    //.SetCellphone("{Put your Cellphone}")
                    //.SetPhone("{Put your Phone}")
                    //.SetFax("{Put your Fax}")
                    //.SetPostalCode("{Put your PostalCode}")
                    //.SetChangeLogo({Put your ChangeLogo})
                    //.SetChangeCover({Put your ChangeCover})
                    //.SetLogoImage("{Put your LogoImage}")
                    //.SetCoverImage("{Put your CoverImage}")
                    //.SetTags({Put your Tags})
                    //.SetTagTrees({Put your TagTrees})
                    //.SetTagTreeCategoryName("{Put your TagTreeCategoryName}")
                    //.SetLink("{Put your Link}")
                    //.SetLat({Put your Lat})
                    //.SetLng({Put your Lng})
                    //.SetAgentFirstName("{Put your AgentFirstName}")
                    //.SetAgentLastName("{Put your AgentLastName}")
                    //.SetAgentCellphoneNumber("{Put your AgentCellphoneNumber}")
                    //.SetAgentNationalCode("{Put your AgentNationalCode}")
                    //.SetChangeAgent({Put your ChangeAgent})
                    .Build();
dealingService.UpdateBusiness(updateBusinessVo, response => Listener.GetResult(response, out output));
```

## دریافت توکن کسب و کار ایجاد شده
 هنگامی که با استفاده از توکن خود کسب و کارهایی را ثبت نمایید، به ازای هر کسب و کار یک apiToken برگردانده می شود که از آن جهت مدیریت امور کسب و کار زیر مجموعه میتوانید استفاده نمایید. در سایر مواقع که لیست کسب و کارهای ثبت شده را دریافت می نمایید این مقدار در لیست برگردانده نمی شود. در صورت نیاز به apiToken کسب و کار ایجاد شده میتوانید توسط سرویس زیر فقط برای یک کسب و کار به شرط اینکه قبلا خودتان آن را ایجاد کرده باشید، توکن کسب و کاری دریافت نمایید. دقت نمایید این توکن ها به مدت نامحدود فعال هستند و تا زمانی که revoke نشوند قابل استفاده می باشند. بنابرین مسائل امنیتی را در استفاده از آن در نظر بگیرید.

```csharp
var output = new ResultSrv<BusinessApiTokenSrv>();
var getApiTokenForCreatedBusinessVo = GetApiTokenForCreatedBusinessVo.ConcreteBuilder
                    .SetToken("{Put your Token}")
                    .SetBusinessId({Put your BusinessId})
                    .Build();
dealingService.GetApiTokenForCreatedBusiness(getApiTokenForCreatedBusinessVo, response => Listener.GetResult(response, out output));
```

## امتیاز دهی به کسب و کار
کاربرانی که خرید موفق داشته باشند و دنبال کننده کسب و کار باشند، می توانند به کسب و کار مربوطه امتیاز دهند، برای ثبت امتیاز کسب و کار توکن دسترسی کاربر مورد نیاز است و از طریق سرویس زیر انجام می گیرد.در صورتی که کاربر کسب و کار را چندین بار امتیازدهی کند، آخرین امتیاز دهی جایگزین می گردد.

```csharp
var output = new ResultSrv<RateSrv>();
var rateBusinessVo = RateBusinessVo.ConcreteBuilder
                    .SetToken("{Put your &#x64E;AccessToken}")
                    .SetBusinessId({Put your BusinessId})
                    .SetRate({Put your Rate})
                    .Build();
dealingService.RateBusiness(rateBusinessVo, response => Listener.GetResult(response, out output));
```

## ثبت نظر برای کسب و کار
 همچنین کاربران می توانند نظر خود را برای یک کسب و کار ثبت نمایند. برای این منظور از سرویس زیر و توکن دسترسی کاربر استفاده نمایید.علاوه بر آن، کسب و کار می تواند برای خودش نیز، نظر ثبت کند. 

 در پاسخ سرویس، شناسه نظر ثبت شده به عنوان result برگردانده می شود.

```csharp
var output = new ResultSrv<long>();
var commentBusinessVo = CommentBusinessVo.ConcreteBuilder
                    .SetToken("{Put your AccessToken}")
                    .SetBusinessId({Put your BusinessId})
                    .SetText("{Put your Text}")
                    .Build();
dealingService.CommentBusiness(commentBusinessVo, response => Listener.GetResult(response, out output));
```

## افزودن کسب و کار به علاقه مندی ها
 با استفاده از سرویس زیر، کاربر می تواند کسب و کار را به لیست علاقمندی های خود اضافه کند.

```csharp
 var output = new ResultSrv<bool>();
var businessFavoriteVo = BusinessFavoriteVo.ConcreteBuilder
                    .SetToken("{Put your &#x64E;AccessToken}")
                    .SetBusinessId({Put your BusinessId})
                    .SetDisFavorite({Put your DisFavorite})
                    .Build();
dealingService.BusinessFavorite(businessFavoriteVo, response => Listener.GetResult(response, out output));
```

## دریافت امتیاز کاربر نسبت به کسب و کار
 برای دریافت اطلاعات مربوط به تعاملات کاربر با کسب و کارها می توان از سرویس زیر استفاده نمود.
 در اینجا منظور از تعامل به عنوان مثال:
- آیا کاربر جاری کسب و کار را دنبال کرده است و یا خیر 
- کسب و کار جزء لیست علاقمندی کاربر می باشد یا خیر 
می باشد.

 اگر توکن کسب وکار را در کد زیر استفاده نمایید، rateCount مربوطه در نتیجه مربوط به تعداد امتیازدهی کاربران مختلف خواهد بود و اگر توکن کاربر لاگین شده را استفاده نمایید، rateCount همیشه برابر با یک خواهد بود. چرا که هر کاربر تنها یک بار قادر به امتیازدهی خواهد بود و با هر بار فراخوانی جدید سرویس امتیازدهی، امتیاز جدید جایگزین امتیاز قبلی خواهد شد و هم چنین مقدار rate برابر با میانگین امتیازهای ثبت شده می باشد که در صورت استفاده از توکن کاربر لاگین شده، مقدار عددی rate با myRate همیشه برابر خواهد بود.

```csharp
var output = new ResultSrv<List<UserBusinessInfoSrv>>();
var userBusinessInfosVo = UserBusinessInfosVo.ConcreteBuilder
                    .SetToken("{Put your AccessToken Or ApiToken}")
                    .SetId({Put your Id})
                    .Build();
dealingService.UserBusinessInfos(userBusinessInfosVo, response => Listener.GetResult(response, out output));
```

##  تایید یا رد نظرات از طرف کسب و کار
 با استفاده از سرویس زیر می توان نظرات را مشاهده نمود و سپس با استفاده از سرویس confirmComment نسبت به رد و یا تایید نظرات اقدام نمود. اگر فراخوانی سرویس با توکن لاگین شده کاربر صورت پذیرد، تنها نظرات کاربر را در نتیجه برمی گرداند و اگر توکن کسب وکار باشد، کل نظرات ثبت شده برای کسب و کار را نمایش خواهد داد.

```csharp
var output = new ResultSrv<List<CommentSrv>>();
var commentBusinessListVo = CommentBusinessListVo.ConcreteBuilder
                    .SetToken("{Put your AccessToken Or ApiToken}")
                    .SetBusinessId({Put your BusinessId})
                    .SetSize({Put your Size})
                    .SetOffset({Put your Offset})
                    //.SetFirstId({Put your FirstId})
                    //.SetLastId({Put your LastId})
                    .Build();
dealingService.CommentBusinessList(commentBusinessListVo, response => Listener.GetResult(response, out output));
```

## تایید یا عدم تایید نظرات
به منظور تایید و یا عدم تایید نظرات ثبت شده درسرویس CommentBusinessList، از سرویس زیر(ConfirmComment) استفاده نمایید.

```csharp
var output = new ResultSrv<CommentSrv>();
var confirmCommentVo = ConfirmCommentVo.ConcreteBuilder
                    .SetToken("{Put your Token}")
                    .SetCommentId({Put your CommentId})
                    .Build();
dealingService.ConfirmComment(confirmCommentVo, response => Listener.GetResult(response, out output));
```


# [Java](#tab/java)

[ابتدا jar فایل مربوطه را دانلود کرده و در پروژه خود قرار دهید.]

(https://github.com/FanapSoft/pod-java-sdk/tree/master/pod-dealing-service-java/Sample%20Code/release "ابتدا jar فایل مربوطه را دانلود کرده و در پروژه خود قرار دهید.")

## ثبت کسب و کار و کاربر جدید
 کسب و کار می‌تواند با استفاده از سرویس زیر، کسب و کارهای دیگری را که با آن‌ها همکاری دارد را ثبت نماید. این امکان برای کارگزاران و کسب و کارهایی که به تسهیم درآمد نیاز دارند بسیار مهم است. با این اقدام، همزمان با ثبت کسب و کار، پنل کاربری نیز ساخته می‌شود. ایمیل کسب و کار و شماره موبایلی که برای او ثبت می‌شود، برای مواقعی که لازم باشد خود آن کسب و کار در پنل مدیریتی خود وارد شود و برخی اقدامات را بر عهده بگیرد، ضروری است و صاحب کسب و کار می‌تواند با استفاده از آن رمز عبور خود را تعیین نماید. بنابراین صحت این موارد را کنترل نمایید. سرویس زیر عملیات مهم زیر را در یک عملیات انجام می‌دهد:

* 	با استفاده از نام کاربری و ایمیل و شماره موبایل که دریافت می‌کند، امکان ورود به پنل مدیریت کسب و کار برای کسب و کار دیگر فراهم می‌شود.
* 	اطلاعات کسب و کار در پلتفرم (اصلی یا سندباکس) ثبت می‌شود.
* 	یک اپلیکیشن (client) پیش‌فرض برای کسب و کار به صورت یکپارچه ایجاد می‌شود. که برای هر دو سرور سندباکس و اصلی اعتبار دارد.
* 	بنابراین در صورتی که سرویس زیر را برای مثال در سندباکس فراخوانی نمودید، برای انتقال به سرور اصلی کافیست با همان توکنی که برای کسب و کار از سرور سندباکس دریافت نموده اید، اطلاعات پروفایل کاربر را در سرور اصلی دریافت نموده و یک کسب و کار برای آن کاربر ثبت نمایید.

در پاسخ سرویس بالا اطلاعات کسب و کار همراه با توکن دائمی آن، برگردانده می‌شود. ضروری است کارگزار توکن را ذخیره و برای اقداماتی که از جانب کسب و کار ثبت شده انجام می‌دهد استفاده نماید و در حفظ و امنیت آن کوشا باشد.

```java
  BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();

        PodDealing podDealing = new PodDealing();

        List<String> permittedGuildCodeList = new ArrayList<>();
        permittedGuildCodeList.add({guild_code});

        try {
            AddUserAndBusinessVo addUserAndBusinessVo = new AddUserAndBusinessVo.Builder(baseInfoVo)
                    .setUsername({userName})
                    .setBusinessName("{businessName}")
                    .setEmail({email})
                    .setCountry({country})
                    .setState({state})
                    .setCity({city})
                    .setAddress({address})
                    .setDescription({description})
                    .setAgentFirstName({agent firstName})
                    .setAgentLastName({agent lastName})
                    .setAgentCellphoneNumber({agent cellphone})
                    .setGuildCode(permittedGuildCodeList )
                    .build();
            podDealing.addUserAndBusiness(addUserAndBusinessVo, new OnGetResponseListener<BusinessSrv>() {
                @Override
                public void onResponse(ResultVo<BusinessSrv> result) {
                    System.out.println(result.getResult().getId());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());

                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());

        }
```

## دریافت لیست اصناف
جهت دریافت لیست اصناف از سرویس زیر استفاده نمایید.

```java
    BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();

        PodDealing podDealing = new PodDealing();

        try {
            GuildListVo guildListVo = new GuildListVo.Builder(baseInfoVo)
                    .setOffset({offset})
                    .setSize({size})
                    .build();
            podDealing.guildList(guildListVo, new OnGetResponseListener<List<GuildSrv>>() {
                @Override
                public void onResponse(ResultVo<List<GuildSrv>> result) {
                    System.out.println(result.getResult().get(2).getName());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }

    }
```

## جستجو و ویرایش کسب و کارها
 برای دریافت لیست کسب و کارهایی که ایجاد نموده‌اید کافی‌است از سرویس زیر استفاده نمایید.
 
```java
 BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();
        List<Long> permittedBizIdList = new ArrayList<>();
        permittedBizIdList.add({biz id});
        PodDealing podDealing = new PodDealing();

        try {
            ListUserCreatedBusinessVo listUserCreatedBusinessVo = new ListUserCreatedBusinessVo.Builder(baseInfoVo)
                    .setSize({size})
                    .setOffset({offset})
                    .build();
            podDealing.listUserCreatedBusiness(listUserCreatedBusinessVo, new OnGetResponseListener<List<BusinessSrv>>() {
                @Override
                public void onResponse(ResultVo<List<BusinessSrv>> result) {
                    System.out.println(result.getResult().get(0).getId());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
```

## ویرایش کسب و کارها
برای ویرایش کسب و کارهایی که ایجاد نموده‌اید از سرویس زیر استفاده نمایید.

توجه داشته باشید، بجز موارد اجباری که عدم ثبت آن‌ها منجر به خطا خواهد شد، عدم ارسال سایر موارد منجر به پاک شدن مقدار قبلی می‌گردد.

```java
  BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();
        List<String> permittedGuildCodeList = new ArrayList<>();
        permittedGuildCodeList.add({guild_code});
        PodDealing podDealing = new PodDealing();

        try {
            UpdateBusinessVo updateBusinessVo = new UpdateBusinessVo.Builder(baseInfoVo)
                    .setBizId({biz id})
                    .setBusinessName({businessName})
                    .setGuildCode(permittedGuildCodeList)
                    .setCountry({country})
                    .setState({state})
                    .setCity({city})
                    .setAddress({address})
                    .setDescription({description})
                    .build();
            podDealing.updateBusiness(updateBusinessVo, new OnGetResponseListener<BusinessSrv>() {
                @Override
                public void onResponse(ResultVo<BusinessSrv> result) {
                    System.out.println(result.getResult().getName());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
```

## دریافت توکن کسب و کار ایجاد شده 
 هنگامی که با استفاده از توکن خود کسب و کارهایی را ثبت نمایید، به ازای هر کسب و کار یک apiToken برگردانده می‌شود که از آن جهت مدیریت امور کسب و کار زیر مجموعه می‌توانید استفاده نمایید. در سایر مواقع که لیست کسب و کارهای ثبت شده را دریافت می‌نمایید این مقدار در لیست برگردانده نمی‌شود. در صورت نیاز به apiToken کسب و کار ایجاد شده می‌توانید توسط سرویس زیر فقط برای یک کسب و کار به شرط این‌که قبلا خودتان آن را ایجاد کرده باشید، توکن کسب و کاری دریافت نمایید. دقت نمایید این توکن‌ها به مدت نامحدود فعال هستند و تا زمانی که revoke نشوند قابل استفاده می‌باشند. بنابرین مسائل امنیتی را در استفاده از آن در نظر بگیرید.

```java
   BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();

        PodDealing podDealing = new PodDealing();

        try {
            GetApiTokenForCreatedBusinessVo getApiTokenForCreatedBusinessVo = new GetApiTokenForCreatedBusinessVo.Builder(baseInfoVo)
                    .setBusinessId({businessId})

                    .build();
            podDealing.getApiTokenForCreatedBusiness(getApiTokenForCreatedBusinessVo, new OnGetResponseListener<BusinessApiTokenSrv>() {
                @Override
                public void onResponse(ResultVo<BusinessApiTokenSrv> result) {
                    System.out.println(result.getResult().getApiToken());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
```

## امتیاز دهی به کسب و کار
 کاربرانی که خرید موفق داشته باشند و دنبال کننده کسب و کار باشند، می‌توانند به کسب و کار مربوطه امتیاز دهند، برای ثبت امتیاز کسب و کار توکن دسترسی کاربر مورد نیاز است و از طریق سرویس زیر انجام می‌گیرد.در صورتی که کاربر کسب و کار را چندین بار امتیازدهی کند، آخرین امتیاز دهی جایگزین می‌گردد.

```java
 BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();

        PodDealing podDealing = new PodDealing();

        try {
            RateBusinessVo rateBusinessVo = new RateBusinessVo.Builder(baseInfoVo)
                    .setBusinessId({businessId})
                    .setRate({rate})

                    .build();
            podDealing.rateBusiness(rateBusinessVo, new OnGetResponseListener<RateSrv>() {
                @Override
                public void onResponse(ResultVo<RateSrv> result) {
                    System.out.println(result.getResult().getRate());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
```

## ثبت نظر برای کسب و کار
 همچنین کاربران می‌توانند نظر خود را برای یک کسب و کار ثبت نمایند. برای این منظور از سرویس زیر و توکن دسترسی کاربر استفاده نمایید.علاوه بر آن، کسب و کار می‌تواند برای خودش نیز، نظر ثبت کند.  در پاسخ سرویس، شناسه نظر ثبت شده به عنوان result برگردانده می‌شود.

```java
 BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();

        PodDealing podDealing = new PodDealing();

        try {
            CommentBusinessVo commentBusinessVo = new CommentBusinessVo.Builder(baseInfoVo)
                    .setBusinessId({businessId})
                    .setText({text})

                    .build();
            podDealing.commentBusiness(commentBusinessVo, new OnGetResponseListener<Long>() {
                @Override
                public void onResponse(ResultVo<Long> result) {
                    System.out.println(result.getMessageId());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
```

## افزودن کسب و کار به علاقه مندی‌ها
 با استفاده از سرویس زیر، کاربر می‌تواند کسب و کار را به لیست علاقمندی‌های خود اضافه کند.

```java
 BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();

        PodDealing podDealing = new PodDealing();

        try {
            BusinessFavoriteVo businessFavoriteVo = new BusinessFavoriteVo.Builder(baseInfoVo)
                    .setBusinessId({businessId})
                    .setDisfavorite({true or false})

                    .build();
            podDealing.businessFavorite(businessFavoriteVo, new OnGetResponseListener<Boolean>() {
                @Override
                public void onResponse(ResultVo<Boolean> result) {
                    System.out.println(result.getResult());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
```

## دریافت امتیاز کاربر نسبت به کسب و کار
برای دریافت اطلاعات مربوط به تعاملات کاربر با کسب و کارها می‌توان از سرویس زیر استفاده نمود. در اینجا منظور از تعامل به عنوان مثال: امتیازی که کاربر به کسب وکار داده است آیا کاربر جاری کسب و کار را دنبال کرده است و یا خیر کسب و کار جزء لیست علاقمندی کاربر می‌باشد یا خیر اگر توکن کسب وکار را در کد زیر استفاده نمایید، rateCount مربوطه در نتیجه مربوط به تعداد امتیازدهی کاربران مختلف خواهد بود و اگر توکن کاربر لاگین شده را استفاده نمایید، rateCount همیشه برابر با یک خواهد بود. چرا که هر کاربر تنها یک بار قادر به امتیازدهی خواهد بود و با هر بار فراخوانی جدید سرویس امتیازدهی، امتیاز جدید جایگزین امتیاز قبلی خواهد شد و هم چنین مقدار rate برابر با میانگین امتیازهای ثبت شده می‌باشد که در صورت استفاده از توکن کاربر لاگین شده، مقدار عددی rate با myRate همیشه برابر خواهد بود.

```java
   BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();
        List<Long> permittedIdList = new ArrayList<>();
        permittedIdList.add({id});
        PodDealing podDealing = new PodDealing();

        try {
            UserBusinessInfosVo userBusinessInfosVo = new UserBusinessInfosVo.Builder(baseInfoVo)
                    .setId(permittedIdList)

                    .build();
            podDealing.userBusinessInfos(userBusinessInfosVo, new OnGetResponseListener<List<UserBusinessInfoSrv>>() {
                @Override
                public void onResponse(ResultVo<List<UserBusinessInfoSrv>> result) {
                    System.out.println(result.getResult().get(0).getRate().getRate());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
```

## تایید یا رد نظرات از طرف کسب و کار
 با استفاده از سرویس زیر می‌توان نظرات را مشاهده نمود و سپس با استفاده از سرویس confirmComment نسبت به رد و یا تایید نظرات اقدام نمود. اگر فراخوانی سرویس با توکن لاگین شده کاربر صورت پذیرد، تنها نظرات کاربر را در نتیجه برمی‌گرداند و اگر توکن کسب وکار باشد، کل نظرات ثبت شده برای کسب و کار را نمایش خواهد داد.

```java
  BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();

        PodDealing podDealing = new PodDealing();

        try {
            CommentBusinessListVo commentBusinessListVo = new CommentBusinessListVo.Builder(baseInfoVo)
                    .setBusinessId({businessId})
                    .setOffset({offset})
                    .setSize({size})
                    .build();
            podDealing.commentBusinessList(commentBusinessListVo, new OnGetResponseListener<List<CommentSrv>>() {
                @Override
                public void onResponse(ResultVo<List<CommentSrv>> result) {
                    System.out.println(result.getResult().get(0).getText());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
```

## تایید یا عدم تایید نظرات
به منظور تایید و یا عدم تایید نظرات ثبت شده درسرویس CommentBusinessList، از سرویس زیر(ConfirmComment) استفاده نمایید.

```java
   BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
                .setServerType(Enum_Server_type.PRODUCTION)
                .build();

        PodDealing podDealing = new PodDealing();

        try {
            ConfirmCommentVo confirmCommentVo = new ConfirmCommentVo.Builder(baseInfoVo)
                    .setCommentId({commentId})

                    .build();
            podDealing.confirmComment(confirmCommentVo, new OnGetResponseListener<Boolean>() {
                @Override
                public void onResponse(ResultVo<Boolean> result) {
                    System.out.println(result.getResult());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }

```


# [NodeJS](#tab/nodejs)

**ماژول** **pod-dealing-service**

کسب و کار ها می تواند کسب و کارهای دیگری را که با آن ها همکاری دارند ثبت نام کنند. این امکان برای کارگزاران و کسب و کارهایی که به تسهیم درآمد نیاز دارند بسیار مفید است. همچنین کاربران می توانند کسب و کارها را دنبال کنند، به آن ها امتیاز دهند و در مورد آن ها نظر دهند تمامی این کارها با استفاده از توابع این ماژول انجام می شود.

**دریافت ماژول**

```node.js
npm install pod-dealing-service
```

**ایجاد یک نمونه از ماژول:**

در صورتی که بخواهید به سرور تست (sandbox) وصل شوید باید از حالت دوم ایجاد سرویس استفاده کنید و مقدار پارامتر serverType را برابر با sandbox قرار دهید. در صورت نیاز مقدار پیش فرض tokenIssuer نیز در سازنده ماژول قابل تنظیم است.

```node.js
const PodDealingService = require(‘pod-user-operations-service’)
let podDealingService= new PodDealingService ({});
// let podDealingService = new PodDealingService ({serverType: ‘sandbox’});
// let podDealingService = new PodDealingService ({tokenIssuer: 0 | 1});
```

## توابع
1.  addUserAndBusiness
2.  listUserCreatedBusiness
3.  updateBusiness
4.  getApiTokenForCreatedBusiness
5.  rateBusiness
6.  commentBusiness
7.  businessFavorite
8.  userBusinessInfos
9.  commentBusinessList
10.  confirmComment


##  addUserAndBusiness
 با استفاده از این تابع می توانید یک کسب و کار ثبت کنید. با این اقدام، همزمان با ثبت کسب و کار، پنل کاربری نیز ساخته می‌شود. ایمیل کسب و کار و شماره موبایلی که برای او ثبت می شود، برای مواقعی که لازم باشد خود آن کسب و کار در پنل مدیریتی خود وارد شود و برخی اقدامات را بر عهده بگیرد، ضروری است و صاحب کسب و کار می تواند با استفاده از آن رمز عبور خود را تعیین نماید. بنابراین صحت این موارد را کنترل نمایید.

```node.js
let addUserAndBusinessData = {
  // ------ REQUIRED ------
  _token_: 'API TOKEN',
  username: 'USERNAME',
  businessName: 'NAME',
  email: 'TEST@TEST.COM',
  guildCode: ['GUILDCODE'],
  country: 'COUNTRY',
  state: 'STATE',
  city: 'CITY',
  address: 'ADDRESS',
  description: 'DESCRIPTION',
  agentFirstName: 'AGENT FIRST NAME',
  agentLastName: 'AGENT LAST NAME',
  agentCellphoneNumber: '09151111111'

  // ------ OPTIONAL ------
  // _token_issuer_: 1
  // firstName: 'FIRST NAME'
  // lastName: 'LAST NAME'
  // sheba: 'SHEBA WITHOUT IR'
  // nationalCode: 'CODE'
  // economicCode: 'CODE'
  // registrationNumber: 'REGISTER NUMBER'
  // cellphone: 'MOBILE'
  // phone: 'PHONE'
  // fax: 'FAX'
  // postalCode: 'POSTAL CODE'
  // description: 'DESCRIPTION'
  // newsReader: 'NEWS READER'
  // logoImage: 'LOGO'
  // coverImage: 'COVER'
  // tags: 'TAG1,TAG2'
  // tagTrees: 'TREE1,TREE2'
  // tagTreeCategoryName: 'CATEGORY'
  // link: 'LINK'
  // lat: 0
  // lng: 0
  // agentNationalCode: 'CODE'
};

podDealingService.addUserAndBusiness(addUserAndBusinessData)
  .then(function (result) {
    console.log('function: addUserAndBusiness ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error addUserAndBusiness ============>', error);
  });
```


نمونه خروجی:

```
{ hasError: false,
  messageId: 0,
  referenceNumber: '235631977',
  errorCode: 0,
  count: 0,
  ott: '1bb96b21d0efb62',
  result:
   { id: 4804,
     name: 'NAME23',
     guilds: [ [Object] ],
     description: 'DESCRIPTION',
     address: 'ADDRESS',
     city: '',
     state: '',
     country: '',
     latitude: 0,
     longitude: 0,
     subscriptionCount: 0,
     subscribed: false,
     numOfComments: 0,
     rate: { rate: 0, rateCount: 0 },
     userId: 2380802,
     ssoId: '11139414',
     numOfProducts: 0,
     email: 'TEST2@TEST.COM',
     fullAddress: 'ADDRESS',
     tags: [],
     tagTrees: [],
     active: false,
     apiToken: '109583e9ea394a99a5f88ccef04c992d',
     agent:
      { id: 2061,
        firstName: 'AGENT FIRST NAME',
        lastName: 'AGENT LAST NAME',
        cellphoneNumber: '09151111111' },
     numOfLike: 0,
     numOfDislike: 0,
     username: 'USERNAME2' } }
```


## listUserCreatedBusiness
 با استفاده از این تابع می توانید لیست کسب و کارهایی را که ثبت کرده اید دریافت کنید یا در میان آن ها جستجو انجام دهید.

```node.js
let listUserCreatedBusinessData = {
  // ------ REQUIRED ------
  _token_: 'API TOKEN'

  // ------ OPTIONAL ------
  // _token_issuer_: 1
  // bizId: ID
  // guildCode: 'GUILD CODE'
  // offset: OFFSET
  // size: SIZE
  // query: 'query'
  // tags: ['TAG1', 'TAG2']
  // tagTrees: ['TREE1', 'TREE2']
  // active: 'ACTIVE'
  // country: 'COUNTRY'
  // city: 'CITY'
  // ssoId: ID
  // username: 'USERNAME'
  // businessName: 'BUSINESS NAME'
  // nationalCode: 'CODE'
  // email: 'TEST@TEST.COM'
  // cellphone: 'MOPBILE'
};
podDealingService.listUserCreatedBusiness(listUserCreatedBusinessData)
  .then(function (result) {
    console.log('function: listUserCreatedBusiness ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error listUserCreatedBusiness ============>', error);
  });
```

نمونه خروجی:

```
{ hasError: false,
  messageId: 0,
  referenceNumber: '235637515',
  errorCode: 0,
  count: 2,
  ott: 'fb78b347f604e7df',
  result:
   [ { id: 4804,
       name: 'NAME23',
       guilds: [Object],
       description: 'DESCRIPTION',
       address: 'ADDRESS',
       city: '',
       state: '',
       country: '',
       latitude: 0,
       longitude: 0,
       subscriptionCount: 0,
       subscribed: false,
       numOfComments: 0,
       rate: [Object],
       userId: 2380802,
       ssoId: '11139414',
       numOfProducts: 0,
       email: 'TEST2@TEST.COM',
       fullAddress: 'ADDRESS',
       tags: [],
       tagTrees: [],
       active: false,
       agent: [Object],
       numOfLike: 0,
       numOfDislike: 0,
       username: 'USERNAME2' },
     { id: 4766,
       name: 'NAME2222',
       guilds: [],
       description: 'DESCRIPTION',
       address: 'ADDRESS',
       city: '',
       state: '',
       country: '',
       latitude: 0,
       longitude: 0,
       subscriptionCount: 0,
       subscribed: false,
       numOfComments: 5,
       rate: [Object],
       userId: 2344899,
       ssoId: '10918554',
       numOfProducts: 0,
       fullAddress: 'ADDRESS',
       tags: [],
       tagTrees: [],
       active: false,
       agent: [Object],
       numOfLike: 0,
       numOfDislike: 0,
       legalInfo: [Object],
       username: 'USERNAME' } ] }
```

## updateBusiness
 با استفاده از این تابع می توانید اطلاعات کسب و کاری را که قبلا ثبت نموده اید ویرایش کنید

```node.js
let updateBusinessData = {
  // ------ REQUIRED ------
  _token_: 'API TOKEN',
  bizId: 0,
  businessName: 'NAME2',
  guildCode: ['GUILD CODE'],
  country: 'COUNTRY',
  state: 'STATE',
  city: 'CITY',
  address: 'ADDRESS',
  description: 'DESCRIPTION'

  // ------ OPTIONAL ------
  // _token_issuer_: 1
  // companyName: 'COMPANY NAME'
  // shopName: 'NAME'
  // shopNameEn: 'NAME'
  // website: 'SITE'
  // dateEstablishing: 'YYYY/MM/DD'
  // firstName: 'FIRST NAME'
  // lastName: 'LAST NAME'
  // sheba: 'SHEBA'
  // nationalCode: 'CODE'
  // economicCode: 'CODE'
  // email: 'TEST@TEST.COM'
  // registrationNumber: 'REGISTRETION NUMBER'
  // cellphone: 'MOBILE'
  // phone: 'PHONE'
  // fax: 'FAX'
  // postalCode: 'CODE'
  // changeLogo: true | false
  // changeCover: true | false
  // logoImage: 'IMAGE'
  // coverImage: 'IMAGE'
  // tags: 'TAG1, TAG2'
  // tagTrees: 'TREE1, TREE2'
  // tagTreeCategoryName: 'CATEGORY'
  // link: 'LINK'
  // lat: LAT
  // lng: LNG
  // agentFirstName: 'FIRST NAME'
  // agentLastName: 'LAST NAME'
  // agentCellphoneNumber: 'MOBILE'
  // agentNationalCode: 'CODE'
  // changeAgent: true | false
};
podDealingService.updateBusiness(updateBusinessData)
  .then(function (result) {
    console.log('function: createPreInvoice ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error createPreInvoice ============>', error);
  });
```

نمونه خروجی:

```
{ hasError: false,
  messageId: 0,
  referenceNumber: '235641490',
  errorCode: 0,
  count: 0,
  ott: 'c4edd9a3f5894f35',
  result:
   { id: 4766,
     name: 'NAME22222',
     guilds: [],
     description: 'DESCRIPTION',
     address: 'ADDRESS',
     city: '',
     state: '',
     country: '',
     latitude: 0,
     longitude: 0,
     subscriptionCount: 0,
     subscribed: false,
     numOfComments: 5,
     rate: { rate: 0, rateCount: 0 },
     userId: 2344899,
     ssoId: '10918554',
     numOfProducts: 0,
     fullAddress: 'ADDRESS',
     tags: [],
     tagTrees: [],
     active: false,
     agent:
      { id: 2022,
        firstName: 'AGENT FIRST NAME',
        lastName: 'AGENT LAST NAME',
        cellphoneNumber: '09151111111' },
     numOfLike: 0,
     numOfDislike: 0,
     legalInfo: { id: 861, dateEstablishing: 0 },
     username: 'USERNAME' } }
```

## getApiTokenForCreatedBusiness

 با استفاده از این تابع می توانید API TOKEN کسب و کاری را که ثبت کرده اید دریافت کنید

```node.js
let getApiTokenForCreatedBusinessData = {
  // ------ REQUIRED ------
  _token_: 'API TOKEN',
  businessId: 0

  // ------ OPTIONAL ------
  // _token_issuer_: 1
};

podDealingService.getApiTokenForCreatedBusiness(getApiTokenForCreatedBusinessData)
  .then(function (result) {
    console.log('function: getApiTokenForCreatedBusiness ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error getApiTokenForCreatedBusiness ============>', error);
  });
```

نمونه خروجی:

```
{ hasError: false,
  messageId: 0,
  referenceNumber: '235653218',
  errorCode: 0,
  count: 0,
  ott: '92bbe2f804b76f5',
  result:
   { business: { id: 4766, name: 'NAME22222', numOfProducts: 0, rate: [Object] },
     apiToken: '131d1facfa994f31a39a4bd69ceafd13',
     clientId: '9327444a9d4b266a7d6c1c76' } }
```

## rateBusiness

 کاربرانی که خرید موفق داشته باشند و دنبال کننده کسب و کار باشند، می توانند به کسب و کار مربوطه امتیاز دهند، برای ثبت امتیاز کسب و کار توکن دسترسی کاربر مورد نیاز است و از طریق سرویس زیر انجام می گیرد.  امتیاز عددی بین صفر تا ده است.

```node.js
let rateBusinessData = {
  // ------ REQUIRED ------
  _token_: 'ACCESS TOKEN',
  businessId: 0,
  rate: 0

  // ------ OPTIONAL ------
  // _token_issuer_: 1
};

podDealingService.rateBusiness(rateBusinessData)
  .then(function (result) {
    console.log('function: rateBusiness ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error rateBusiness ============>', error);
  });
```

## commentBusiness

 کاربران می توانند نظر خود را برای یک کسب و کار ثبت نمایند. برای این منظور از این تابع به همراه توکن دسترسی کاربر استفاده نمایید. علاوه بر آن، کسب و کار می تواند برای خودش نیز، نظر ثبت کند.

```node.js
let commentBusinessData = {
  // ------ REQUIRED ------
  _token_: 'ACCESS TOKEN',
  businessId: 0,
  text: 'THIS IS MY COMMENT!!!'

  // ------ OPTIONAL ------
  // _token_issuer_: 1

};

podDealingService.commentBusiness(commentBusinessData)
  .then(function (result) {
    console.log('function: commentBusiness ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error commentBusiness ============>', error);
  });
```

نمونه خروجی:

```
{ hasError: false,
  messageId: 0,
  referenceNumber: '235661049',
  errorCode: 0,
  count: 0,
  ott: '1df917b39b6f256a',
  result: 761 }
```

## businessFavorite
 با استفاده از سرویس زیر، کاربر می تواند کسب و کار را به لیست علاقمندی های خود اضافه کند

```node.js
let businessFavoriteData = {
  // ------ REQUIRED ------
  _token_: 'ACCESS TOKEN',
  businessId: 0,
  disfavorite: false // or true

  // ------ OPTIONAL ------
  // _token_issuer_: 1
};
podDealingService.businessFavorite(businessFavoriteData)
  .then(function (result) {
    console.log('function: getInvoiceListAsFile ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error getInvoiceListAsFile ============>', error);
  });
```

نمونه خروجی:

```
{ hasError: false,
  messageId: 0,
  referenceNumber: '235681579',
  errorCode: 0,
  count: 0,
  ott: '1fe4b80152166a9d',
  result: true }
```

## userBusinessInfos

 برای دریافت اطلاعات مربوط به تعاملات کاربر با کسب و کارها می توان از تابع زیر استفاده نمود. در اینجا منظور از تعامل به عنوان مثال:

+ امتیازی که کاربر به کسب وکار داده است
+ آیا کاربر جاری کسب و کار را دنبال کرده است و یا خیر
+ کسب و کار جزء لیست علاقمندی کاربر می باشد یا خیر

می باشد اگر توکن کسب وکار را در کد زیر استفاده نمایید، rateCount مربوطه در نتیجه مربوط به تعداد امتیازدهی کاربران مختلف خواهد بود و اگر توکن کاربر لاگین شده را استفاده نمایید، rateCount همیشه برابر با یک خواهد بود. چرا که هر کاربر تنها یک بار قادر به امتیازدهی خواهد بود و با هر بار فراخوانی جدید سرویس امتیازدهی، امتیاز جدید جایگزین امتیاز قبلی خواهد شد. و هم چنین مقدار rate برابر با میانگین امتیازهای ثبت شده می باشد که در صورت استفاده از توکن کاربر لاگین شده، مقدار عددی rate با myRate همیشه برابر خواهد بود.

```node.js
let userBusinessInfosData = {
  // ------ REQUIRED ------
  _token_: 'API TOKEN or ACCESS TOKEN',
  id: [0]

  // ------ OPTIONAL ------
  // _token_issuer_: 1
};

podDealingService.userBusinessInfos(userBusinessInfosData)
  .then(function (result) {
    console.log('function: userBusinessInfos ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error userBusinessInfos ============>', error);
  });
```

نمونه خروجی:

```
{ hasError: false,
  messageId: 0,
  referenceNumber: '235689819',
  errorCode: 0,
  count: 0,
  ott: 'aac455ebe47d016e',
  result:
   [ { id: 4766,
       name: 'NAME22222',
       subscriptionCount: 0,
       subscribed: false,
       rate: [Object],
       favorite: false } ] }
```

##  commentBusinessList

 با استفاده از این تابع می توانید نظرات ثبت شده را مشاهده کنید. اگر فراخوانی سرویس با توکن لاگین شده کاربر صورت پذیرد، تنها نظرات کاربر را در نتیجه برمی گرداند و اگر توکن کسب وکار باشد، کل نظرات ثبت شده برای کسب و کار را نمایش خواهد داد.

```node.js
let commentBusinessListData = {
  // ------ REQUIRED ------
  _token_: 'API TOKEN OR ACCESS TOKEN',
  businessId: 0,
  offset: 0

  // ------ OPTIONAL ------
  // _token_issuer_: 1
  // size: SIZE
  // firstId: ID
  // lastId: ID
};
```

نمونه خروجی:

```
{ hasError: false,
  messageId: 0,
  referenceNumber: '235764041',
  errorCode: 0,
  count: 1,
  ott: '9fb8b1ac78a1a14c',
  result:
   [ { id: 743,
       text: 'THIS IS MY COMMENT!!!',
       timestamp: 1563015948498,
       user: [Object],
       confirmed: true,
       numOfLikes: 0,
       numOfComments: 0,
       liked: false } ] }
```

## confirmComment
  کسب و کار می تواند نظرات داده شده توسط کاربران را تایید یا رد نماید. دقت داشته باشید که API TOKEN شما باید توکن کسب و کاری باشد که نظر برای آن ثبت شده است.

```node.js
let confirmCommentData = {
  // ------ REQUIRED ------
  _token_: 'API TOKEN', // API TOKEN OF SUB BUSINESS
  commentId: 0

  // ------ OPTIONAL ------
  // _token_issuer_: 1
};
podDealingService.confirmComment(confirmCommentData)
  .then(function (result) {
    console.log('function: reduceInvoice ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error reduceInvoice ============>', error);
  });
```

نمونه خروجی:

```
{ hasError: false,
  messageId: 0,
  referenceNumber: '235829512',
  errorCode: 0,
  count: 0,
  ott: '64cb03da085b75fd',
  result: true }
```


# [PHP](#tab/php)

کسب و کار ها می‌توانند کسب و کارهای دیگری را که با آن ها همکاری دارند ثبت نام کنند. این امکان برای کارگزاران و کسب و کارهایی که به تسهیم درآمد نیاز دارند بسیار مفید است. همچنین کاربران می‌توانند کسب‌و‌کارها را دنبال کنند، به آن‌ها امتیاز دهند و در مورد آن‌ها نظر دهند تمامی این کارها با استفاده از توابع این پکیج انجام می‌شود.

برای اطلاعات بیشتر به لینک زیر مراجعه کنید
[راهنما](http://docs.pod.land/v1.0.8.0/Developer/Brokerage/683/AddUserAndBusiness "راهنما")

**نصب** **پکیج** **pod-dealing-service**

برای نصب پکیج pod-dealing-service کافیست دستور زیر را در روت اصلی برنامه اجرا کنید.

```
composer require pod-dealing-service
```



در ادامه توضیحات و نمونه کدهای استفاده از متدهای کلاس DealingService آورده شده است:

ابتدا کدهای مشترک قابل استفاده برای هریک از متد ها را مشاهده می کنید.

```php
# required classes
use Pod\Dealing\Service\DealingService;
use Pod\Base\Service\Exception\ValidationException;
use Pod\Base\Service\Exception\PodException;

# set serverType to DealingService::PRODUCTION_SERVER or DealingService::SANDBOX_SERVER
putenv("SERVER_TYPE=". DealingService::PRODUCTION_SERVER);
const API_TOKEN = '{PUT API TOKEN}';
# access token will be expired each 15 minutes refresh this token with SSOService->refreshAccessToken
const ACCESS_TOKEN = '{PUT ACCESS TOKEN}';
const TOKEN_ISSUER = 1;

#  instantiates a DealingService
$dealingService = new DealingService();
```

## ثبت کسب و کار و کاربر جدید
با استفاده از تابع addUserAndBusiness می توانید یک کسب و کار ثبت کنید. با این اقدام، همزمان با ثبت کسب و کار، پنل کاربری نیز ساخته می‌شود. ایمیل کسب و کار و شماره موبایلی که برای او ثبت می شود، برای مواقعی که لازم باشد خود آن کسب و کار در پنل مدیریتی خود وارد شود و برخی اقدامات را بر عهده بگیرد، ضروری است و صاحب کسب و کار می تواند با استفاده از آن رمز عبور خود را تعیین نماید. بنابراین صحت این موارد را کنترل نمایید.

```php
    $param =
        [
        ## ========================= Required Parameters  ========================
            "_token_"               => API_TOKEN,      # Api_Token
            "username"            => 'USER NAME',
            "businessName"      => 'BUSINESS NAME',
            "email"                 => 'EMAIL',
            "guildCode"           => ['GUILD_CODE'],
            "country"              => 'COUNTRY',
            "state"                 => 'STATE',
            "city"                   => 'CITY',
            "address"             => 'ADDRESS',
            "description"         => 'DESCRIPTION',
            "agentFirstName"    => 'AGENT FIRST NAME',
            "agentLastName"    => 'AGENT LAST NAME',
            "agentCellphoneNumber"  => 'AGENT PHONE NUMBER',
    ## ======================== Optional Parameters  ===========================
#             "_token_issuer_"       => TOKEN_ISSUER,
#             "firstName"            => 'FIRST NAME',
#             "lastName"            => 'LAST NAME',
#             "sheba"                => 'SHEBA WITHOUT IR',
#             "nationalCode"        => 'CODE',
#             "economicCode"      => 'CODE',
#             "registrationNumber" => 'REGISTER NUMBER',
#             "cellphone"            => '09120000000',
#             "phone"                => '051322222222',
#             "fax"                   => 'FAX',
#             "postalCode"         => '9185175673',
#             "newsReader"        => 'true/false',
#             "logoImage"          => 'LOGO',
#             "coverImage"         => 'COVER',
#             "tags"                 => 'TAG1,TAG2',
#             "tagTrees"           => 'TREE1,TREE2',
#             "tagTreeCategoryName"  => 'CATEGORY',
#             "link"                 => 'LINK',
#             "lat"                  => 0,
#             "lng"                 => 0,
#             "agentNationalCode"   => 'CODE',

    ];
    try {
        $result = $dealingService->addUserAndBusiness($param);
        print_r($result);
    } catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```

لیست پارامترهای ورودی متد addUserAndBusiness

| نام فیلد             | نوع             | عنوان                              | توضیحات                                                                   | اجباری؟ |
| -------------------- | --------------- | ---------------------------------- | ------------------------------------------------------------------------- | ------- |
| username             | string          | نام کاربری کسب و کار جدید          | نکته + منحصر به فرد، فاقد space و حتما با حروف انگلیسی ثبت گردد.         | اجباری  |
| country              | string          | کشور محل کسب و کار                 |                                                                           | اجباری  |
| agentCellphoneNumber | string          | شماره موبایل نماینده               | نکته + به صورت 09123456789 وارد شود                                      | اجباری  |
| agentLastName        | string          | نام خانوادگی نماینده               |                                                                           | اجباری  |
| agentFirstName       | string          | نام نماینده                        |                                                                           | اجباری  |
| description          | string          | توضیحات                            |                                                                           | اجباری  |
| address              | string          | آدرس محل کسب و کار                 |                                                                           | اجباری  |
| businessName         | string          | نام کسب و کار                      |                                                                           | اجباری  |
| state                | string          | استان محل کسب و کار                |                                                                           | اجباری  |
| city                 | string          | شهر محل کسب و کار                  |                                                                           | اجباری  |
| email                | string          | ایمیل                              | نکته + فرمت باید به صورت email باشد                                      | اجباری  |
| guildCode            | array of string | لیست کد اصناف                      |                                                                           | اجباری  |
| cellphone            | string          | شماره موبایل نماینده کسب و کار     | نکته + به صورت 09123456789 وارد شود                                      |         |
| tagTrees             | string          | تگ های درختی                       | نکته + با ، (ویرگول) موارد را از هم جدا کنید                             |         |
| firstName            | string          | نام شخص نماینده کسب و کار          |                                                                           |         |
| lastName             | string          | نام خانوادگی شخص نماینده کسب و کار |                                                                           |         |
| sheba                | string          | کد شبا حساب بانکی                  | نکته + شبا که به صورت عددی وارد می شود. (بدون IR)                        |         |
| lng                  | number          | طول جغرافیایی                      |                                                                           |         |
| lat                  | number          | عرض جغرافیایی                      |                                                                           |         |
| link                 | string          | Link                               | نکته + لینک دسترسی به کسب و کار از طریق sso                              |         |
| tagTreeCategoryName  | string          | دسته درخت تگ                       |                                                                           |         |
| coverImage           | string          | کاور کسب و کار                     | نکته + آدرس اینترنتی تصویر کاور کسب و کار که به صورت مستقیم در دسترس است |         |
| tags                 | string          | تگ های آیتم                        | نکته + با ، (ویرگول) موارد را از هم جدا کنید                             |         |
| phone                | string          | شماره تلفن                         | نکته + شماره تلفن با پیش شماره وارد شود                                  |         |
| logoImage            | string          | لوگو کسب و کار                     | نکته + آدرس اینترنتی تصویر لوگو کسب و کار که به صورت مستقیم در دسترس است |         |
| newsReader           | string          | News Reader                        | نکته + محدود کردن دسترسی کسب و کار                                       |         |
| nationalCode         | string          | شناسه ملی کسب و کار                | نکته + کد 11 رقمی                                                        |         |
| economicCode         | string          | کد اقتصادی کسب و کار               |                                                                           |         |
| registrationNumber   | string          | شماره ثبت کسب و کار                |                                                                           |         |
| postalCode           | string          | کد پستی                            | نکته + کد پستی 10 رقمی                                                   |         |
| fax                  | string          | شماره فکس                          | نکته + در صورت ورد همراه با پیش شماره وارد شود                           |         |
| agentNationalCode    | string          | کد ملی نماینده                     | نکته + کد ملی 10 رقمی و بدون خط تیره و فاصله                             |         |

## listUserCreatedBusiness
 با استفاده از این تابع می توانید لیست کسب و کارهایی را که ثبت کرده اید دریافت کنید یا در میان آن ها جستجو انجام دهید.

```php
    $param =
        [
        ## ========================= Required Parameters  =========================
            "_token_"               => API_TOKEN,  # Api_Token
        ## ========================= Optional Parameters  =========================
#            "_token_issuer_"        => TOKEN_ISSUER,
#            "bizId"                 => 'BUSINESS ID',
#            "username"              => 'USER NAME',
#            "businessName"          => 'BUSINESS NAME',
#            "email"                 => 'EMAIL',
#            "guildCode"             => ['GUILD_CODE'],   # &#x644;&#x6CC;&#x633;&#x62A; &#x6A9;&#x62F; &#x635;&#x646;&#x641; &#x6A9;&#x633;&#x628; &#x648; &#x6A9;&#x627;&#x631;
#            "country"               => 'COUNTRY',
#            "state"                 => 'STATE',
#            "city"                  => 'CITY',
#            "active"                => true | false,
#            "offset"                => OFFSET,
#            "size"                  => SIZE,
#            "ssoId"                 => 'SSO ID',             # &#x634;&#x646;&#x627;&#x633;&#x647; sso &#x6A9;&#x627;&#x631;&#x628;&#x631;
#            "query"                 => 'QUERY',            # &#x645;&#x648;&#x631;&#x62F; &#x62C;&#x633;&#x62A;&#x62C;&#x648; &#x631;&#x648;&#x6CC; &#x628;&#x6CC;&#x632;&#x6CC;&#x646;&#x633; &#x647;&#x627;&#x6CC; &#x645;&#x648;&#x62C;&#x648;&#x62F;
#            "sheba"                 => 'SHEBA WITHOUT IR',
#            "nationalCode"          => 'CODE',
#            "economicCode"          => 'CODE',
#            "cellphone"             => '09120000000',
#            "tags"                  => ['TAG1', 'TAG2'],            # &#x644;&#x6CC;&#x633;&#x62A; &#x62A;&#x6AF;
#            "tagTrees"              => ['TREE1', 'TREE2'],              # &#x644;&#x6CC;&#x633;&#x62A; &#x62F;&#x631;&#x62E;&#x62A; &#x62A;&#x6AF;

    ];
    try {
        $result = $dealingService->listUserCreatedBusiness($param);
        print_r($result);
    } catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```

لیست پارامترهای ورودی متد listUserCreatedBusiness

| نام فیلد     | نوع              | عنوان                           | توضیحات                                            | اجباری؟ |
| ------------ | ---------------- | ------------------------------- | -------------------------------------------------- | ------- |
| bizId        | array of integer | شناسه کسب و کار                 |                                                    |         |
| city         | string           | نام شهر                         |                                                    |         |
| email        | string           | آدرس ایمیل کاربر                | نکته + فرمت باید به صورت email باشد               |         |
| economicCode | string           | کد اقتصادی کسب و کار            |                                                    |         |
| nationalCode | string           | شناسه ملی کسب و کار             |                                                    |         |
| sheba        | string           | کد شبا حساب بانکی               | نکته + شبا که به صورت عددی وارد می شود. (بدون IR) |         |
| businessName | string           | نام کسب و کار                   |                                                    |         |
| username     | string           | نام کاربری                      |                                                    |         |
| ssoId        | string           | شناسه sso کاربر                 |                                                    |         |
| state        | string           | نام استان                       |                                                    |         |
| guildCode    | array of string  | لیست کد اصناف                   |                                                    |         |
| country      | string           | نام کشور                        |                                                    |         |
| active       | string           | وضعیت                           |                                                    |         |
| tagTrees     | array of string  | لیست درخت تگ                    |                                                    |         |
| tags         | array of string  | لیست تگ                         |                                                    |         |
| query        | string           | مورد جستجو روی بیزینس های موجود |                                                    |         |
| size         | integer          | تعداد رکورد در هر صفحه          |                                                    |         |
| offset       | integer          | اندیس شروع                      |                                                    |         |
| cellphone    | string           | شماره موبایل نماینده کسب و کار  | نکته + به صورت 09123456789 وارد شود               |         |

## updateBusiness
 با استفاده از این تابع می توانید اطلاعات کسب و کاری را که قبلا ثبت نموده اید ویرایش کنید

```php

$param =
        [
        ## ===================== *Required Parameters  ======================
            "_token_"               => API_TOKEN,                 # Api_Token
            "bizId"                 => '{put business id}',                      # &#x634;&#x646;&#x627;&#x633;&#x647; &#x6A9;&#x633;&#x628; &#x648; &#x6A9;&#x627;&#x631;
            "businessName"          => 'BUSINESS NAME',             # &#x646;&#x627;&#x645; &#x6A9;&#x633;&#x628; &#x648; &#x6A9;&#x627;&#x631;
            "guildCode"             => ['GUILD_CODE'],              # &#x644;&#x6CC;&#x633;&#x62A; &#x6A9;&#x62F; &#x627;&#x635;&#x646;&#x627;&#x641;
            "country"               => 'COUNTRY',                            # &#x6A9;&#x634;&#x648;&#x631;
            "state"                 => 'STATE',                             # &#x627;&#x633;&#x62A;&#x627;&#x646;
            "city"                  => 'CITY',                                # &#x634;&#x647;&#x631;
            "address"               => 'ADDRESS',                            # &#x622;&#x62F;&#x631;&#x633;
            "description"           => 'DESCRIPTION',                     # &#x62A;&#x648;&#x636;&#x6CC;&#x62D;&#x627;&#x62A;
        ## ===================== Optional Parameters  =====================
#            "_token_issuer_"         => 1,
#            "email"                  => 'EMAIL',
#            "companyName"            => 'COMPANY NAME',            # &#x646;&#x627;&#x645; &#x634;&#x631;&#x6A9;&#x62A;
#            "shopName"               => 'SHOP NAME',               # &#x646;&#x627;&#x645; &#x641;&#x631;&#x648;&#x634;&#x6AF;&#x627;&#x647;
#            "shopNameEn"             => 'Shopping Center',         # &#x646;&#x627;&#x645; &#x627;&#x646;&#x6AF;&#x644;&#x6CC;&#x633;&#x6CC; &#x641;&#x631;&#x648;&#x634;&#x6AF;&#x627;&#x647;
#            "dateEstablishing"       => 'yyyy/mm/dd',              # &#x62A;&#x627;&#x631;&#x6CC;&#x62E; &#x634;&#x645;&#x633;&#x6CC; &#x62A;&#x627;&#x633;&#x6CC;&#x633; yyyy/mm/dd
#            "website"                => 'WEBSITE',                 # &#x648;&#x628;&#x633;&#x627;&#x6CC;&#x62A;
#            "sheba"                  => 'SHEBA',                   # &#x634;&#x628;&#x627; &#x6A9;&#x647; &#x628;&#x647; &#x635;&#x648;&#x631;&#x62A; &#x639;&#x62F;&#x62F;&#x6CC; &#x648;&#x627;&#x631;&#x62F; &#x645;&#x6CC; &#x634;&#x648;&#x62F;. (&#x628;&#x62F;&#x648;&#x646; IR)
#            "firstName"              => 'FIRST NAME',              # &#x646;&#x627;&#x645; &#x634;&#x62E;&#x635; &#x646;&#x645;&#x627;&#x6CC;&#x646;&#x62F;&#x647; &#x6A9;&#x633;&#x628; &#x648; &#x6A9;&#x627;&#x631;
#            "lastName"               => 'LAST NAME',               # &#x646;&#x627;&#x645; &#x62E;&#x627;&#x646;&#x648;&#x627;&#x62F;&#x6AF;&#x6CC; &#x634;&#x62E;&#x635; &#x646;&#x645;&#x627;&#x6CC;&#x646;&#x62F;&#x647; &#x6A9;&#x633;&#x628; &#x648; &#x6A9;&#x627;&#x631;
#            "nationalCode"           => 'CODE',                    # &#x634;&#x646;&#x627;&#x633;&#x647; &#x645;&#x644;&#x6CC; &#x6A9;&#x633;&#x628; &#x648; &#x6A9;&#x627;&#x631;
#            "economicCode"           => 'CODE',                    # &#x6A9;&#x62F; &#x627;&#x642;&#x62A;&#x635;&#x627;&#x62F;&#x6CC; &#x6A9;&#x633;&#x628; &#x648; &#x6A9;&#x627;&#x631;
#            "registrationNumber"     => 'REGISTER NUMBER',         # &#x634;&#x645;&#x627;&#x631;&#x647; &#x62B;&#x628;&#x62A; &#x6A9;&#x633;&#x628; &#x648; &#x6A9;&#x627;&#x631;
#            "cellphone"              => '09120000000',             # &#x634;&#x645;&#x627;&#x631;&#x647; &#x645;&#x648;&#x628;&#x627;&#x6CC;&#x644; &#x646;&#x645;&#x627;&#x6CC;&#x646;&#x62F;&#x647; &#x6A9;&#x633;&#x628; &#x648; &#x6A9;&#x627;&#x631;
#            "phone"                  => '02122222222',
#            "fax"                    => 'FAX',
#            "postalCode"             => 'POSTAL CODE',
#            "newsReader"             => 'true/false',
#            "changeLogo"             => 'LOGO',        # &#x62F;&#x631; &#x635;&#x648;&#x631;&#x62A;&#x6CC; &#x6A9;&#x647; &#x628;&#x62E;&#x648;&#x627;&#x647;&#x6CC;&#x62F; &#x62A;&#x635;&#x648;&#x6CC;&#x631; &#x644;&#x648;&#x6AF;&#x648; &#x631;&#x627; &#x62A;&#x63A;&#x6CC;&#x6CC;&#x631; &#x62F;&#x647;&#x6CC;&#x62F; true &#x648;&#x627;&#x631;&#x62F; &#x6A9;&#x646;&#x6CC;&#x62F;
#            "changeCover"            => 'COVER',       # &#x62F;&#x631; &#x635;&#x648;&#x631;&#x62A;&#x6CC; &#x6A9;&#x647; &#x628;&#x62E;&#x648;&#x627;&#x647;&#x6CC;&#x62F; &#x62A;&#x635;&#x648;&#x6CC;&#x631; &#x6A9;&#x627;&#x648;&#x631; &#x631;&#x627; &#x62A;&#x63A;&#x6CC;&#x6CC;&#x631; &#x62F;&#x647;&#x6CC;&#x62F; true &#x648;&#x627;&#x631;&#x62F; &#x6A9;&#x646;&#x6CC;&#x62F;
#            "logoImage"              => 'LOGO',          # logo image url
#            "coverImage"             => 'COVER',         # cover image url
#            "tags"                   => 'TAG1,TAG2',       # &#x62A;&#x6AF; &#x647;&#x627;&#x6CC; &#x622;&#x6CC;&#x62A;&#x645; &#x6A9;&#x647; &#x628;&#x627; , &#x627;&#x632; &#x647;&#x645; &#x62C;&#x62F;&#x627; &#x634;&#x62F;&#x647; &#x627;&#x646;&#x62F;
#            "tagTrees"               => 'TREE1,TREE2',
#            "tagTreeCategoryName"    => 'CATEGORY',   # &#x62F;&#x633;&#x62A;&#x647; &#x62F;&#x631;&#x62E;&#x62A; &#x62A;&#x6AF;
#            "link"                   => 'LINK',                  # &#x644;&#x6CC;&#x646;&#x6A9; &#x62F;&#x633;&#x62A;&#x631;&#x633;&#x6CC; &#x628;&#x647; &#x6A9;&#x633;&#x628; &#x648; &#x6A9;&#x627;&#x631; &#x627;&#x632; &#x637;&#x631;&#x6CC;&#x642; sso
#            "lat"                    => 0,
#            "lng"                    => 0,
#            "agentFirstName"         => 'FIRST NAME'         # &#x646;&#x627;&#x645; &#x646;&#x645;&#x627;&#x6CC;&#x646;&#x62F;&#x647;
#            "agentLastName"          => 'LAST NAME'        # &#x646;&#x627;&#x645; &#x62E;&#x627;&#x646;&#x648;&#x627;&#x62F;&#x6AF;&#x6CC; &#x646;&#x645;&#x627;&#x6CC;&#x646;&#x62F;&#x647;
#            "agentCellphoneNumber"   => 'MOBILE'            # &#x634;&#x645;&#x627;&#x631;&#x647; &#x62A;&#x644;&#x641;&#x646; &#x646;&#x645;&#x627;&#x6CC;&#x646;&#x62F;&#x647;
#            "agentNationalCode"      => 'CODE'                # &#x6A9;&#x62F; &#x645;&#x644;&#x6CC; &#x646;&#x645;&#x627;&#x6CC;&#x646;&#x62F;&#x647;
#            "changeAgent"            => true | false          # &#x62F;&#x631; &#x635;&#x648;&#x631;&#x62A;&#x6CC; &#x6A9;&#x647; &#x628;&#x62E;&#x648;&#x627;&#x647;&#x6CC;&#x62F; &#x646;&#x645;&#x627;&#x6CC;&#x646;&#x62F;&#x647; &#x631;&#x627; &#x62A;&#x63A;&#x6CC;&#x6CC;&#x631; &#x62F;&#x647;&#x6CC;&#x62F; true &#x648;&#x627;&#x631;&#x62F; &#x646;&#x645;&#x627;&#x6CC;&#x6CC;&#x62F;
    ];
    try {
        $result = $dealingService->updateBusiness($param);
        print_r($result);
    } catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```

لیست پارامترهای ورودی متد updateBusiness

| نام فیلد             | نوع             | عنوان                          | توضیحات                                                                    | اجباری؟ |
| -------------------- | --------------- | ------------------------------ | -------------------------------------------------------------------------- | ------- |
| bizId                | integer         | شناسه کسب و کار                |                                                                            | اجباری  |
| guildCode            | array of string | لیست کد اصناف                  |                                                                            | اجباری  |
| description          | string          | توضیحات                        |                                                                            | اجباری  |
| address              | string          | آدرس محل کسب و کار             |                                                                            | اجباری  |
| city                 | string          | شهر محل کسب و کار              |                                                                            | اجباری  |
| state                | string          | استان محل کسب و کار            |                                                                            | اجباری  |
| businessName         | string          | نام کسب و کار                  |                                                                            | اجباری  |
| country              | string          | کشور محل کسب و کار             |                                                                            | اجباری  |
| lastName             | string          | نام خانوادگی نماینده کسب و کار |                                                                            |         |
| changeLogo           | string          | Change Logo                    | نکته + در صورتی که بخواهید تصویر لوگو را تغییر دهید true وارد کنید        |         |
| agentNationalCode    | string          | کد ملی نماینده                 | نکته + کد ملی 10 رقمی و بدون خط تیره و فاصله                              |         |
| agentCellphoneNumber | string          | شماره موبایل نماینده           | نکته + به صورت 09123456789 وارد شود                                       |         |
| agentLastName        | string          | نام خانوادگی نماینده           |                                                                            |         |
| agentFirstName       | string          | نام نماینده                    |                                                                            |         |
| lng                  | number          | طول جغرافیایی                  |                                                                            |         |
| lat                  | number          | عرض جغرافیایی                  |                                                                            |         |
| link                 | string          | Link                           | نکته + لینک دسترسی به کسب و کار از طریق sso                               |         |
| tagTreeCategoryName  | string          | دسته درخت تگ                   |                                                                            |         |
| tagTrees             | string          | تگ های درختی                   | نکته + با ، (ویرگول) موارد را از هم جدا کنید                              |         |
| tags                 | string          | تگ های آیتم                    | نکته + با ، (ویرگول) موارد را از هم جدا کنید                              |         |
| coverImage           | string          | کاور کسب و کار                 | نکته + آدرس اینترنتی تصویر کاور کسب و کار که به صورت مستقیم در دسترس است  |         |
| logoImage            | string          | لوگو کسب و کار                 | نکته + آدرس اینترنتی تصویر لوگو کسب و کار که به صورت مستقیم در دسترس است  |         |
| changeCover          | string          | Change Cover                   | نکته + در صورتی که بخواهید تصویر کاور را تغییر دهید true وارد کنید        |         |
| companyName          | string          | نام شرکت                       |                                                                            |         |
| sheba                | string          | کد شبا حساب بانکی              | نکته + شبا که به صورت عددی وارد می شود. (بدون IR)                         |         |
| shopName             | string          | نام فروشگاه                    |                                                                            |         |
| shopNameEn           | string          | نام انگلیسی فروشگاه            |                                                                            |         |
| website              | string          | آدرس وب سایت                   |                                                                            |         |
| dateEstablishing     | string          | تاریخ تاسیس به صورت شمسی       | نکته + تاریخ به صورت yyyy/mm/dd وارد شود                                  |         |
| postalCode           | string          | کد پستی                        | نکته + شماره تلفن با پیش شماره وارد شود                                   |         |
| fax                  | string          | شماره فکس                      | نکته + در صورت ورد همراه با پیش شماره وارد شود                            |         |
| phone                | string          | شماره تلفن                     | نکته + شماره تلفن با پیش شماره وارد شود                                   |         |
| cellphone            | string          | شماره موبایل نماینده کسب و کار | نکته + به صورت 09123456789 وارد شود                                       |         |
| firstName            | string          | نام نماینده کسب و کار          |                                                                            |         |
| registrationNumber   | integer         | شماره ثبت کسب و کار            |                                                                            |         |
| email                | string          | ایمیل                          |                                                                            |         |
| economicCode         | string          | کد اقتصادی کسب و کار           |                                                                            |         |
| nationalCode         | string          | شناسه ملی کسب و کار            |                                                                            |         |
| changeAgent          | string          | Change Agent                   | نکته + در صورتی که بخواهید اطلاعات نماینده را تغییر دهید true وارد نمایید |         |

## getApiTokenForCreatedBusiness

 با استفاده از این تابع می توانید API TOKEN کسب و کاری را که ثبت کرده اید دریافت کنید

```php

    $param =
        [
        ## =================== Required Parameters  ======================
            "_token_"               => API_TOKEN,  # Api_Token
            'businessId'            => '{put business id}',            # id of business
        ## ================== Optional Parameters  =======================
#            "_token_issuer_"        => TOKEN_ISSUER,
        ];
    try {
        $result = $dealingService->getApiTokenForCreatedBusiness($param);
        print_r($result);
    } catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```


لیست پارامترهای ورودی متد getApiTokenForCreatedBusiness

|  نام فیلد |  نوع |  عنوان |  توضیحات |  اجباری؟ |
| --- | --- | --- | --- | --- |
| businessId | integer |  شناسه کسب و کار |  |  اجباری |

##  rateBusiness
 کاربرانی که خرید موفق داشته باشند و دنبال کننده کسب و کار باشند، می توانند به کسب و کار مربوطه امتیاز دهند، برای ثبت امتیاز کسب و کار توکن دسترسی کاربر مورد نیاز است و از طریق سرویس زیر انجام می گیرد.  امتیاز عددی بین صفر تا ده است.

```php
    $param =
        [
        ## ======================= *Required Parameters  ===========================
            "_token_"       => ACCESS_TOKEN,          # Access_Token
            'businessId'    => '{put business id}',        # id of business
            'rate'          => '{put rate, between 0 and 10}',              # [user rate between 0 and 10]
        ## ======================= Optional Parameters  ============================
#            "_token_issuer_"        => TOKEN_ISSUER,      # default is 1

        ];
    try {
        $result = $dealingService->rateBusiness($param);
        print_r($result);
    } catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```

لیست پارامترهای ورودی متد rateBusiness

| نام فیلد   | نوع     | عنوان                     | توضیحات                             | اجباری؟ |
| ---------- | ------- | ------------------------- | ----------------------------------- | ------- |
| businessId | integer | شناسه کسب و کار           |                                     | اجباری  |
| rate       | integer | امتیاز کاربر به کسب و کار | نکته + حداقل 0 است + حداکثر 10 است | اجباری  |

## commentBusiness

 کاربران می توانند نظر خود را برای یک کسب و کار ثبت نمایند. برای این منظور از این تابع به همراه توکن دسترسی کاربر استفاده نمایید. علاوه بر آن، کسب و کار می تواند برای خودش نیز، نظر ثبت کند.

```php
    $param =
        [
        ## ======================= Required Parameters  ==========================
            "_token_"       => ACCESS_TOKEN,            # Access_Token
            'businessId'    => '{put business id}',            # id of business
            'text'          => "COMMENT",       # [user rate between 0 and 10]
        ## ====================== Optional Parameters  ===========================
#            "_token_issuer_"        => TOKEN_ISSUER,          # default is 1
        ];
    try {
        $result = $dealingService->commentBusiness($param);
        print_r($result);
    } catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```

لیست پارامترهای ورودی متد commentBusiness

| نام فیلد   | نوع     | عنوان                       | توضیحات | اجباری؟ |
| ---------- | ------- | --------------------------- | ------- | ------- |
| businessId | integer | شناسه کسب و کار             |         | اجباری  |
| text       | string  | نظر کاربر در مورد کسب و کار |         | اجباری  |



## businessFavorite
 با استفاده از سرویس زیر، کاربر می تواند کسب و کار را به لیست علاقمندی های خود اضافه کند

```php
    $param =
        [
        ## ===================== *Required Parameters  =====================
            "_token_"               => ACCESS_TOKEN,      # Access_Token
            'businessId'            => '{put business id}',                # id of business
            'disfavorite'           => "true/false",        # or true
        ## =================== Optional Parameters  ========================
#            "_token_issuer_"        => TOKEN_ISSUER,      # default is 1

        ];
    try {
        $result = $dealingService->businessFavorite($param);
        print_r($result);
    } catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```

لیست پارامترهای ورودی متد businessFavorite

| نام فیلد    | نوع     | عنوان           | توضیحات                                                                                                   | اجباری؟ |
| ----------- | ------- | --------------- | --------------------------------------------------------------------------------------------------------- | ------- |
| businessId  | integer | شناسه کسب و کار |                                                                                                           | اجباری  |
| disfavorite | string  | Disfavorite     | نکته + اگر خالی یا false باشد، به علاقه مندی ها اضافه می شود و اگر true باشد، از علاقه مندی ها حذف میشود |         |

##  userBusinessInfos
 برای دریافت اطلاعات مربوط به تعاملات کاربر با کسب و کارها می توان از تابع زیر استفاده نمود. در اینجا منظور از تعامل به عنوان مثال:

* 	امتیازی که کاربر به کسب وکار داده است
* 	آیا کاربر جاری کسب و کار را دنبال کرده است و یا خیر
* 	کسب و کار جزء لیست علاقمندی کاربر می باشد یا خیر

می باشد اگر توکن کسب وکار را در کد زیر استفاده نمایید، rateCount مربوطه در نتیجه مربوط به تعداد امتیازدهی کاربران مختلف خواهد بود و اگر توکن کاربر لاگین شده را استفاده نمایید، rateCount همیشه برابر با یک خواهد بود. چرا که هر کاربر تنها یک بار قادر به امتیازدهی خواهد بود و با هر بار فراخوانی جدید سرویس امتیازدهی، امتیاز جدید جایگزین امتیاز قبلی خواهد شد. و هم چنین مقدار rate برابر با میانگین امتیازهای ثبت شده می باشد که در صورت استفاده از توکن کاربر لاگین شده، مقدار عددی rate با myRate همیشه برابر خواهد بود.

```php
    $param =
        [
        ## ===================== Required Parameters  ========================
            "_token_"   => {ACCESS_TOKEN | API_TOKEN},          # [ACCESS_TOKEN] &#x6CC;&#x627; [ACCESS_TOKEN]
            "id"        => ["id of business"],                  # id of business
        ## ==================== Optional Parameters  =========================
#            "_token_issuer_"        => TOKEN_ISSUER,          # default is 1
        ];
    try {
        $result = $dealingService->userBusinessInfos($param);
        print_r($result);
    } catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```

لیست پارامترهای ورودی متد userBusinessInfos

|  نام فیلد |  نوع |  عنوان |  توضیحات |  اجباری؟ |
| --- | --- | --- | --- | --- |
| id | array of integer |  لیست شناسه های کسب و کار |  |  اجباری |


## commentBusinessList
 با استفاده از این تابع می توانید نظرات ثبت شده را مشاهده کنید. اگر فراخوانی سرویس با توکن لاگین شده کاربر صورت پذیرد، تنها نظرات کاربر را در نتیجه برمی گرداند و اگر توکن کسب وکار باشد، کل نظرات ثبت شده برای کسب و کار را نمایش خواهد داد.

```php

    $param =
        [
        ## ================== *Required Parameters  =======================
            "_token_"           =>{ACCESS_TOKEN | API_TOKEN},  # [API_TOKEN] &#x6CC;&#x627; [ACCESS_TOKEN]
            'businessId'        => "BUSINESS ID",               # id of business
            'offset'            => '{put offset}',                           # [user rate between 0 and 10]
        ## ================= Optional Parameters  =========================
            # "_token_issuer_"   => TOKEN_ISSUER,              # default is 1
            # "size": 10,
            # "firstId": ID,
            # "lastId" : ID,
        ];
    try {
        $result = $dealingService->commentBusinessList($param);
        print_r($result);
    } catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```

لیست پارامترهای ورودی متد commentBusinessList

| نام فیلد   | نوع     | عنوان           | توضیحات                                                                                                  | اجباری؟ |
| ---------- | ------- | --------------- | -------------------------------------------------------------------------------------------------------- | ------- |
| businessId | integer | شناسه کسب و کار |                                                                                                          | اجباری  |
| firstId    | integer | First Id        | نکته + در صورتی که این فیلد وارد شود فیلدهای lastId و offset نباید وارد شوند و نتیجه صعودی مرتب می شود. |         |
| lastId     | integer | Last Id         | نکته + در صورتی که این فیلد وارد شود فیلدهای firstId و offset نباید وارد شوند و نتیجه نزولی مرتب می شود |         |
| offset     | integer | Offset          | نکته + در صورتی که این فیلد وارد شود فیلدهای lastId و firstId نباید وارد شوند و نتیجه نزولی مرتب می شود |         |
| size       | integer | Size            | نکته + تعداد رکورد در هر صفحه                                                                           |         |

## confirmComment
  کسب و کار می تواند نظرات داده شده توسط کاربران را تایید یا رد نماید. دقت داشته باشید که API TOKEN شما باید توکن کسب و کاری باشد که نظر برای آن ثبت شده است.

```php
    $param =
        [
        ## ==================== *Required Parameters  =========================
            "_token_"           => API_TOKEN,     # Api_Token
            'commentId'         => '{put comment id}',            # id of comment
        ## ==================== Optional Parameters  ==========================
#            "_token_issuer_"    => TOKEN_ISSUER,              # default is 1

        ];
    try {
        $result = $dealingService->confirmComment($param);
        print_r($result);
    } catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```

لیست پارامترهای ورودی متد confirmComment

|  نام فیلد |  نوع |  عنوان |  توضیحات |  اجباری؟ |
| --- | --- | --- | --- | --- |
| commentId | integer |  شناسه نظر |  |  اجباری |

<div class="tab-end">
</div>
