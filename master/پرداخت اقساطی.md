- [مقدمه](#menu)
- [ثبت اقساط](#menu)
- [وضعیت اقساط](#menu)
- [لغو خرید اقساطی](#menu)
- [لینک‌های مرتبط](#menu)


## مقدمه
در تمام پرداخت های اقساطی، وجود 4 مولفه ضروری است:

- خریدار: که درخواست خرید به صورت اقساطی یا اعتباری دارد
- ضامن: که پیرو قراردادی که با خریداران متقاضی دارد، طبق اصول مورد نظر خود، عملکرد خریدار را تا سقف معینی ضمانت می کند.
- تسهیلات دهنده: که طبق قراردادی که با ضامن و فروشنده دارد، تسهیلات اعتباری یا نقدی را با شرایط بازپرداخت مشخص هنگام خرید در اختیار مشتری قرار می دهد
- فروشنده: که پیرو قراردادی که با تسهیلات دهنده دارد، اجناس یا خدمات خود را به صورت اقساطی به فروش می رساند.

<br/>
در سرویس اقساط پاد، امکان تعریف شرایط مختلف وجود دارد و ممکن است در شرایطی، 2 یا 3 مولفه ادغام شوند.

در این مثال، ضامن بانک پاسارگاد است و تسهیلات دهنده و فروشنده هردو یک کسب و کار هستند. کسب و کار می تواند با ارائه ی لیست اقساط به خریدار، با حمایت بانک پاسارگاد اقدام به فروش اقساطی به خریدار نماید.

### تعاریف

**قرارداد:** موجودیتی است که نحوه ی تعامل طرفین یک قرارداد تسهیلاتی را مشخص می کند. در قرار داد تسهیلات دهنده، ضامن، فروشنده و خریدار مشخص می شوند. همچنین محدودیت های محل مصرف تسهیلات، طح های بازپرداخت، نرخ سود و نرخ تضمین نیز در قرارداد ثبت و هر تسهیلات جدید مبتنی بر این قرارداد ارائه می گردد.

**خریدار:** هویتی است که به واسطه ی وجود یک سپرده ی بلند مدت نزد بانک و ارائه درخواست استفاده از خدمات خرید آنلاین اقساطی در یکی از شعب بانک (ثبت نام در طرح)، تقاضای خرید کالا یا خدمات را دارد. و با مراجعه به وب سایت فروشگاه طرف قرارداد خرید آنلاین اقساطی بانک می تواند کالا یا خدمات را به صورت قسطی دریافت نماید.

**مبلغ پیش پرداخت:** مبلغ پیش پرداخت مبلغی است که فروشنده تمایل دارد هنگام خرید کالا و با هدایت خریدار به درگاه خرید آنلاین اقساطی از خریدار دریافت نماید. این مبلغ می تواند صفر باشد.

**اقساط:** لیستی شامل شماره قسط، مبلغ قابل پرداخت قسط و موعد پرداخت قسط می باشد که خریدار باید به کسب و کار پرداخت نماید. به ازای هر قسط یک فاکتور برای مشتری ایجاد میگردد که در موعد مقرر پرداخت می شود.

**تسویه زودتر از موعد:** کسب و کار لازم است لیستی جهت تسویه زودتر از موعد خریدار ارائه دهد و نسبت به تعداد اقساط باقیمانده مبلغ قابل پرداخت خریدار را مشخص نماید. خریدار میتواند از طریق سامانه بانکداری مجازی یا مراجعه به شعبه، تسویه زودتر از موعد انجام دهد.

**درگاه خرید آنلاین اقساطی :** سایتی است متعلق به بانک که در آن خریدار پس از انتخاب موارد مورد خرید خود در سایت فروشنده، به آنجا هدایت میشود و در آنجا با هدایت به سامانه بانکداری مجازی و تایید هویت، مبلغ پیش پرداخت توسط خریدار پرداخت شده و در نهایت بانک فروشنده را از نتیجه تراکنش آگاه می سازد.

<br/>

در نمودار زیر روند کلی بهره گیری از امکانات فروش اقساطی در این مثال  نشان داده شده است:


<div class="mermaid">
graph TD  
A((شروع))  
A-.->B  
B( صدور فاکتور توسط فروشنده)-.->C  
C(هدایت مشتری به درگاه پاد)-.->D
M(وضعیت اقساط)-.->O
D(انتخاب روش پرداخت اقساطی توسط مشتری و فعالسازی اقساط)---E
subgraph ا
E(ورود به حساب کاربری پاد)-.->F
F(انتخاب روش پرداخت اقساطی)-.->G
G(احراز هویت با روش مورد تایید ضامن_بانک پاسارگاد)-.->H
H(مشاهده لیست اقساط و لیست تسویه زودتر از موعد)-.->I
I(ثبت شماره وثیقه و انتخاب منبع پرداخت اقساط)
end
I-.->N
N(تایید پرداخت توسط فروشنده)-.->M 
O((پایان))
</div>

<div class="box-end">
</div>

## ثبت اقساط
جهت ثبت اطلاعات اقساط مورد نظر خود برای یک کاربر، سرویس زیر را فراخوانی کنید.



```javascript
HEADER:
        _token_=[api_token]
        _token_issuer_= 1
        Content-Type=application/x-www-form-urlencoded
Method: POST
Url:
        [platform-address]/nzh/biz/createLoan/
Parameters:
        userId= *               
        guildCode= *
        currencyCode = * 		
        installmentAmount = *
        installmentDueDate = *
        preSettlementPaidInstallmentCount = *
        preSettlementAmount = *
        billNumber = *
        totalAmount = *
        primaryAmount = *
        verificationNeeded = *
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/createLoan</div>

پارامترهای مورد نیاز برای این سرویس که مقدار دادن به تمامی آن ها اجباری می باشد در جدول ذیل آمده است:

<table class="table table-bordered">
	<tbody>
		<tr>
			<td style="text-align: center;">
				<strong>نام پارامتر</strong></td>
			<td style="text-align: center;">
				<strong>شرح</strong></td>
		</tr>
		<tr>
			<td>
				&nbsp;guildCode</td>
			<td>
				&nbsp;کد صنف جهت واریز اقساط</td>
		</tr>
		<tr>
			<td>
				&nbsp;currencyCode</td>
			<td>
				&nbsp;کد ارز</td>
		</tr>
		<tr>
			<td>
				&nbsp;installmentAmount</td>
			<td>
				&nbsp;مبلغ اقساط</td>
		</tr>
		<tr>
			<td>
				&nbsp;installmentDueDate</td>
			<td>
				&nbsp;سررسید اقساط - فرمت yyyy/mm/dd</td>
		</tr>
		<tr>
			<td>
				&nbsp;preSettlementPaidInstallmentCount&nbsp;&nbsp;</td>
			<td>
				&nbsp;تعداد اقساط پرداخت شده</td>
		</tr>
		<tr>
			<td>
				&nbsp;preSettlementAmount</td>
			<td>
				&nbsp;مبلغ باقی مانده برای تسویه زودتر از موعد</td>
		</tr>
		<tr>
			<td>
				&nbsp;billNumber</td>
			<td>
				&nbsp;شماره قبض یکتا - مقدار این پارامتر رقم در نظر گرفته شده است و نه عدد.(به عنوان مثال مقدار 9 از 09 متمایز است.) در صورت وجه اشتراک بین اقساط خود، این شیوه نام گذاری پیش نهاد می گردد.</td>
		</tr>
		<tr>
			<td>
				&nbsp;totalAmount</td>
			<td>
				&nbsp;جمع کل مبلغ</td>
		</tr>
		<tr>
			<td>
				&nbsp;primaryAmount</td>
			<td>
				&nbsp;مبلغ پیش پرداخت&nbsp;</td>
		</tr>
		<tr>
			<td>
				&nbsp;verificationNeeded</td>
			<td>
				&nbsp;تایید دو مرحله ای&nbsp;</td>
		</tr>
	</tbody>
</table>

مبلغ اقساط می تواند در هر مرحله پرداخت قسط، متفاوت باشد. حداقل مبلغ برای فیلد totalAmount، هزار ریال می باشد؛در غیر این صورت فراخوانی سرویس پرداخت، ممکن نخواهد بود.

توجه داشته باشید در صورت درخواست برای اضافه نمودن چند قسط، باید به همان تعداد فیلدهای **" سررسید قسط "**، **" تعداد اقساط پرداخت شده جهت تسویه زودتر از موعد "** و **" مبلغ پرداخت شده جهت تسویه زودتر از موعد "** را وارد نمایید؛ در غیر این صورت، با خطای **" درخواست نامعتبر"**  کد خطای 101، رو به رو خواهید شد.
<div class="box-end">
</div>

## وضعیت اقساط
برای مشاهده وضعیت اقساط و گرفتن آن ها، از سرویس ذیل استفاده نمایید:


```javascript
Header:
        _token_=[API_TOKEN]
        _token_issuer_=1
Method:
        GET
Url:
        [platform-address]/nzh/biz/getLoan
Parameters:
        id=[the created loan id]*
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/getLoan</div>

<div class="box-end">
</div>


## لغو خرید اقساطی

### لغو تراکنش خرید از جانب فروشگاه:
در صورتی که فروشنده مایل به لغو تراکنش خرید باشد می‌تواند درخواست خود را با فراخوانی سرویس زیر، ارسال کند؛در این حالت، **مبلغ بازگشتی** را **فروشگاه** مشخص می‌کند.

بدیهی است مبلغ بازگشتی از فروشگاه نمی‌تواند از مبالغ پرداختی خریدار که شامل مبلغ پیش پرداخت و اقساط پرداخت شده است، بیش‌تر باشد.


```javascript
Header:
        _token_=[API_TOKEN]
        _token_issuer_=1
Method:
        GET
Url:
        [platform-address]/nzh/biz/getLoan
Parameters:
        id=[the created loan id]*
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/refundLoan</div>

<br/>

### تسویه زودتر از موعد:
در صورتی که خریدار تصمیم بگیرد کلیه اقساط خود را زودتر از موعد مقرر تسویه کند، باید مبلغ تسویه را برای فاکتور درخواستی به اعلام بانک برساند.

### اضافه کردن به قسط:
عملیات اضافه کردن قسط به اقساط را در صورتی می‌توان انجام داد که مجموع مبالغ اقساط پس از به روز رسانی، بیش‌تر از مبلغ کل برای فاکتور نباشد، در غیر این‌صورت اقساط آپدیت نشده و در همان وضعیت خود باقی می‌ماند.

<div class="box-end">
</div>

## لینک‌های مرتبط

- [مقدمه](/documents/introduction/)
- [مفاهیم](/documents/concepts/)
- [استاندارد و خطاها](/documents/errors/)
- [شروع به کار](/documents/get-started/)
- [پکیج‌ها](/documents/packages/)

<div class="box-end">
</div>

