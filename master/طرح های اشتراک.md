- [مقدمه](#menu)
- [تعریف طرح اشتراک](#menu)
- [لیست طرح های اشتراک](#menu)
- [ویرایش طرح اشتراک](#menu)
- [فعال سازی اشتراک برای کاربر](#menu)
- [درخواست فعال سازی طرح اشتراک](#menu)
- [فعال سازی طرح اشتراک](#menu)
- [لیست اشتراک ها](#menu)
- [ثبت میزان مصرف](#menu)
- [لینک‌های مرتبط](#menu)


## مقدمه

**تمام امکانات طرح‌های اشتراکی در پکیج subscription قرار دارد.برای اطلاعات بیشتر به [پکیج سرویس‌ها](app/documents/packages/) مراجعه کنید**

در مواردی ممکن است کسب و کار اقدام به فروش محصولات کسب و کار دیگر نماید یا به هر دلیلی بخشی از مبلغ دریافتی به یک یا چند کسب و کار دیگر تعلق داشته باشد. اهمیت این موضوع در امور مالیاتی مشهود و راه حل آن بسیار ضروری است.برای پرداخت کردن فاکتور ها روش های متفاوتی وجود دارد، که می توان با استفاده از این روش ها فاکتور را پرداخت کرد:توسط سرویس های " ایجاد و مدیریت طرح های اشتراکی " که  در ادامه توضیح داده خواهد شد کسب و کار و مشتریان میتوانند از بسترها و سرویس های یکدیگر بر اساس قوانینی که قابل مدیریت و تعریف شدن میباشد استفاده نمایند و در صورت لزوم مبالغی نیز در ازای استفاده از این امکانات پرداخت نمایند.

<br/>

برای مثال یک کسب و کار میتواند با استفاده از این بخش از " پلتفرم پاد "  فروش بسته های اینترنتی حجمی و ساعتی و یا سرویس های ارزش افزوده که مبنای مالی آنها بر حسب تعدد استفاده و نحوه فراخوانی سرویس ها میباشد را پیاده سازی نماید.

<div class="box-end">
</div>

## تعریف طرح اشتراک

توسط سرویس زیر قادر خواهید بود طرح یا طرح های مورد نیاز خود را تعریف و ایجاد نمایید. دو نوع طرح در این سرویس قابل تعریف است:

<div class="mermaid">
graph TD  
A((شروع))  
A-.->B  
B(ثبت محصول)-.->C  
C(تعریف طرح برای محصول)-.->M 
M((پایان))
</div>

- تعریف طرح برای محصول
- طرح مسدودی: مبلغ طرح در حساب خود مشتری مسدود شده و پس از پایان طرح، باقیمانده ی آن آزاد می گردد. در این نوع قیمت طرح برابر با حداکثر مقدار قابل استفاده توسط مشتری می باشد و محدودیت های تعداد یا مقدار ignore می شوند.

**نکته**
- قبل از ایجاد هر طرح ابتدا باید یک محصول بعنوان مشخصات برای طرح مورد نطر خود ثبت و شناسه (entityId) آن را برای ثبت طرح نگهداری نمایید. این محصول در فاکتورهای مشتری در ارتباط با مصرف طرح، به عنوان محصول خریداری شده ثبت میگردد.
- قیمت محصولی که ثبت میکنید برای طرح در نظر گرفته نخواهد شد و تاثیری در آن ندارد.

|        نام پارامتر        | مقدار قابل ارسال                          |توضحات                         |
|----------------|-------------------------------|-----------------------------|
|periodTypeCode|        SUBSCRIPTION_PLAN_PERIOD_TYPE_YEARLY    |    سالانه    |
|periodTypeCode|         SUBSCRIPTION_PLAN_PERIOD_TYPE_MONTHLY  |      ماهانه    |
|periodTypeCode|         SUBSCRIPTION_PLAN_PERIOD_TYPE_DAILY    |      روزانه    |
|type          |          SUBSCRIPTION_PLAN_TYPE_BLOCK          |      مسدودی    |
|type          |          SUBSCRIPTION_PLAN_TYPE_CASH           |      نقدی    |

<br/>

<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<SubscriptionPlanSrv>();
            var addSubscriptionPlanVo = AddSubscriptionPlanVo.ConcreteBuilder
                                .SetServiceCallParameters(internalServiceCallVo)
                                .SetName("{Put your Name}")
                                .SetPrice({Put your Price})
                                .SetPeriodTypeCode({Put your PeriodTypeCode})
                                .SetPeriodTypeCount({Put your PeriodTypeCount})
                                .SetType({Put your Type})
                                .SetGuildCode("{Put your GuildCode}")
                                .SetEntityId({Put your EntityId})
                                //.SetUsageCountLimit({Put your UsageCountLimit})
                                //.SetUsageAmountLimit({Put your UsageAmountLimit})
                                //.SetPermittedGuildCode({Put your PermittedGuildCode})
                                //.SetPermittedBusinessId({Put your PermittedBusinessId})
                                //.SetPermittedProductId({Put your PermittedProductId})
                                //.SetCurrencyCode("{Put your CurrencyCode}")
                                .Build();
            subscriptionService.AddSubscriptionPlan(addSubscriptionPlanVo, response => Listener.GetResult(response, out output));
    }
    catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/addSubscriptionPlan</div>

# [Java](#tab/java)

``` java
//        List<String> scVoucherHashs =new ArrayList<>();
//        scVoucherHashs.add("RFSFGDYEDYGS");
BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken(GUILD_CODE)
                .setToken_issuer(1)
//                .setScApiKey("SDFJKSHFJwshfJshfDJH")
//                .setScVoucherHash(scVoucherHashs)
                .build();

        PodSubscription podSubscription = new PodSubscription();



        List<String> permittedGuildCodeList = new ArrayList<>();
        permittedGuildCodeList.add(GUILD_CODE);

        List<Long> permittedBussinessId = new ArrayList<>();
        permittedBussinessId.add(4131L);

        List<Long> permittedProductId = new ArrayList<>();
        permittedProductId.add(16263L);

        try {
            AddSubscriptionPlanVo addSubscriptionPlanVo = new AddSubscriptionPlanVo.Builder(baseInfoVo)
                    .setPeriodTypeCount(1L)
                    .setPermittedGuildCode(permittedGuildCodeList)
                    .setPermittedBusinessId(permittedBussinessId)
                    .setPermittedProductId(permittedProductId)
                    .setProductId(16263L)
                    .setName("نام پلن")
                    .setPrice(new BigDecimal(1))
                    .setPeriodTypeCode(Enum_Period_Type_Code.SUBSCRIPTION_PLAN_PERIOD_TYPE_MONTHLY.getPeriodTypeCode())
                    .setType(Enum_Type.SUBSCRIPTION_PLAN_TYPE_CASH.getType())
                    .setGuildCode(GUILD_CODE)
                    .setCurrencyCode("IRR")
                    .build();
            podSubscription.addSubscriptionPlan(addSubscriptionPlanVo, new OnGetResponseListener<SubscriptionPlanSrv>() {
                @Override
                public void onResponse(ResultVo<SubscriptionPlanSrv> result) {
                    System.out.println(result.getResult().getId());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/addSubscriptionPlan</div>

# [PHP](#tab/php)

``` php
$param =
        [
        ## ========================= *Required Parameters  =====================
            'name'             => '{put plan name}', 
            'price'            => '{put plan price}',
            'periodTypeCode'   => '{put period type code}', 
            'periodTypeCount'  => '{put period type count}', 
            'type'             => 'put plan type',
            'guildCode'        => 'put guild code', 
             # کد محصول ثبت شده برای این طرح *توجه مقدار entityId محصول باید فرستاده شود*
            'productId'        => '{put product id}',
        ## ============================ Optional Parameters  ===================
#            'usageCountLimit'      => {put usage count limit}, 
#            'usageAmountLimit'     => {put usage amount limit}, 
#            'permittedGuildCode'   => [{put permitted guild codes}], 
#            'permittedBusinessId'  =>[{put permitted business ids}],  
#            'permittedProductId'   =>[{{put permitted product ids}}], 
#            'currencyCode'        => '',   # like IRR
#            'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
#            'scApiKey'           => '{Put service call Api Key}',
        ];
    try {
        $result = $SubscriptionService->addSubscriptionPlan($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/addSubscriptionPlan</div>

# [Nodejs](#tab/nodejs)

``` javascript
let addSubscriptionPlanData = {
  // ------ REQUIRED ------
  name: 'PLAN1',
  price: 0,
  periodTypeCode: 'SUBSCRIPTION_PLAN_PERIOD_TYPE_DAILY', // 'SUBSCRIPTION_PLAN_PERIOD_TYPE_YEARLY' | 'SUBSCRIPTION_PLAN_PERIOD_TYPE_MONTHLY' | 'SUBSCRIPTION_PLAN_PERIOD_TYPE_DAILY'
  periodTypeCount: 0,
  type: 'SUBSCRIPTION_PLAN_TYPE_CASH', // 'SUBSCRIPTION_PLAN_TYPE_BLOCK' | 'SUBSCRIPTION_PLAN_TYPE_CASH'
  productId: 0,
  guildCode: 'GUILD CODE'

  // ------ OPTIONAL ------
  // usageCountLimit: 0,
  // usageAmountLimit: 0,
  // permittedGuildCode: ['GUILD CODE', 'GUILD CODE', 'GUILD CODE'],
  // permittedBusinessId: [0, 0, 0],
  // permittedProductId: [0, 0, 0],
  // currencyCode: 'IRR'
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiToken: 'SC API TOKEN'
};

podSubscription.addSubscriptionPlan(addSubscriptionPlanData)
  .then(function (result) {
    console.log('function: addSubscriptionPlan ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error addSubscriptionPlan ============>', error);
  });

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/addSubscriptionPlan</div>

<div class="tab-end">
</div>




<div class="box-end">
</div>


## لیست طرح های اشتراک

توسط سرویس subscriptionPlanList قادر خواهید بود لیست طرح های اشتراکی ثبت شده را مشاهده و براساس فیلترهای مختلف از آنها گزارش تهیه و نمایش دهید.


<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<List<SubscriptionPlanSrv>>();
            var subscriptionPlanListVo = SubscriptionPlanListVo.ConcreteBuilder
                                .SetServiceCallParameters(internalServiceCallVo)
                                .SetOffset({Put your Offset})
                                .SetSize({Put your Size})
                                //.SetId({Put your Id})
                                //.SetPeriodTypeCode({Put your PeriodTypeCode})
                                //.SetPeriodTypeCountFrom({Put your PeriodTypeCountFrom})
                                //.SetPeriodTypeCountTo({Put your PeriodTypeCountTo})
                                //.SetFromPrice({Put your FromPrice})
                                //.SetToPrice({Put your ToPrice})
                                //.SetEnable({Put your Enable})
                                //.SetPermittedGuildCode({Put your PermittedGuildCode})
                                //.SetPermittedBusinessId({Put your PermittedBusinessId})
                                //.SetPermittedProductId({Put your PermittedProductId})
                                //.SetCurrencyCode("{Put your CurrencyCode}")
                                //.SetTypeCode({Put your TypeCode})
                                .Build();
            subscriptionService.SubscriptionPlanList(subscriptionPlanListVo, response => Listener.GetResult(response, out output));
    }
    catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/subscriptionPlanList</div>

# [Java](#tab/java)

``` java
//        List<String> scVoucherHashs =new ArrayList<>();
//        scVoucherHashs.add("RFSFGDYEDYGS");
BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
        .setToken({token})
        .setToken_issuer(1)
//                .setScApiKey("SDFJKSHFJwshfJshfDJH")
//                .setScVoucherHash(scVoucherHashs)
        .build();

PodSubscription podSubscription = new PodSubscription();



List<String> permittedGuildCodeList = new ArrayList<>();
permittedGuildCodeList.add({GuildCode});

List<Long> permittedBussinessId = new ArrayList<>();
permittedBussinessId.add(4131L);

List<Long> permittedProductId = new ArrayList<>();
permittedProductId.add({ProductId});

try {
    SubscriptionPlanListVo subscriptionPlanListVo = new SubscriptionPlanListVo.Builder(baseInfoVo)
            .setBaseInfoVo(baseInfoVo)
            .setOffset(0L)
            .setSize(10L)
            .build();
    podSubscription.subscriptionPlanList(subscriptionPlanListVo, new OnGetResponseListener<List<SubscriptionPlanSrv>>() {
        @Override
        public void onResponse(ResultVo<List<SubscriptionPlanSrv>> result) {
            System.out.println(result.getResult().size());
        }

        @Override
        public void onFailed(PodSubscriptionException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
    });
} catch (PodSubscriptionException e) {
    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
}

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/subscriptionPlanList</div>

# [PHP](#tab/php)

``` php
    $param =
        [
        ## ============================ *Required Parameters  =========================
            'offset' => '{put page number}',
            'size' => '{put output size}',
        ## =========================== Optional Parameters  ===========================
            'id' => '{put plan id}',
#          'periodTypeCode' =>'put period type code',
#          'fromPrice' =>{put minimum price},
#          'toPrice' =>{put maximum price},
#          'periodTypeCountFrom' => {put minimum count of period},
#          'periodTypeCountTo' => {put maximum count of period},
#          'typeCode'=> 'put plan type',
#          'enable'=> '{true/false}',
#          'permittedGuildCode'=> [{put permitted Guild Codes}],
#          'permittedBusinessId'=>[{put permitted Business Ids}],
#          'permittedProductId'=>[{put permitted Product Ids}],
#          'currencyCode' => '', 
#          'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
#          'scApiKey'           => '{Put service call Api Key}',
        ];
    try {
        $result = $SubscriptionService->subscriptionPlanList($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/subscriptionPlanList</div>

# [Nodejs](#tab/nodejs)

``` javascript
let subscriptionPlanListData = {
  // ------ REQUIRED ------
  offset: 0,
  size: 10

  // ------ OPTIONAL ------
  // id: 0,
  // periodTypeCode: 'SUBSCRIPTION_PLAN_PERIOD_TYPE_DAILY', // 'SUBSCRIPTION_PLAN_PERIOD_TYPE_YEARLY' | 'SUBSCRIPTION_PLAN_PERIOD_TYPE_MONTHLY' | 'SUBSCRIPTION_PLAN_PERIOD_TYPE_DAILY'
  // periodTypeCountFrom: 0,
  // periodTypeCountTo: 0,
  // fromPrice: 0,
  // toPrice: 0,
  // typeCode: 'SUBSCRIPTION_PLAN_TYPE_CASH', // 'SUBSCRIPTION_PLAN_TYPE_BLOCK' | 'SUBSCRIPTION_PLAN_TYPE_CASH'
  // enable: true,
  // permittedGuildCode: ['GUILD CODE', 'GUILD CODE', 'GUILD CODE'],
  // permittedBusinessId: [0, 0, 0],
  // permittedProductId: [0, 0, 0],
  // currencyCode: 'IRR'
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiToken: 'SC API TOKEN'
};

podSubscription.subscriptionPlanList(subscriptionPlanListData)
  .then(function (result) {
    console.log('function: subscriptionPlanList ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error subscriptionPlanList ============>', error);
  });

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/subscriptionPlanList</div>

<div class="tab-end">
</div>




<div class="box-end">
</div>


## ویرایش طرح اشتراک

توسط سرویس updateSubscriptionPlan قادر خواهید بود طرح های اشتراکی که قبلا تعریف شده را ویرایش نمایید.



<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<SubscriptionPlanSrv>();
            var updateSubscriptionPlanVo = UpdateSubscriptionPlanVo.ConcreteBuilder
                                .SetServiceCallParameters(internalServiceCallVo)
                                .SetId({Put your Id})
                                //.SetPeriodTypeCode({Put your PeriodTypeCode})
                                //.SetPeriodTypeCount({Put your PeriodTypeCount})
                                //.SetUsageCountLimit({Put your UsageCountLimit})
                                //.SetName("{Put your Name}")
                                //.SetPrice({Put your Price})
                                //.SetEnable({Put your Enable})
                                .Build();
            subscriptionService.UpdateSubscriptionPlan(updateSubscriptionPlanVo, response => Listener.GetResult(response, out output));
    }
    catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/updateSubscriptionPlan</div>

# [Java](#tab/java)

``` java
List<String> scVoucherHashs=new ArrayList<>();
//scVoucherHashs.add("ghjdshfjshf");
BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
        .setToken(TOKEN)
        .setToken_issuer(1)
        //.setScApiKey("")
        //.setScVoucherHash(scVoucherHashs)
        .build();
PodSubscription podSubscription = new PodSubscription();
//List<String> scVoucherHashs=new ArrayList<>();
//scVoucherHashs.add("ghjdshfjshf");

try {
    UpdateSubscriptionPlanVo UpdateSubscriptionPlanVo = new UpdateSubscriptionPlanVo.Builder(baseInfoVo)
            .setId(62L).setPeriodTypeCount(2L).setPeriodTypeCode("SUBSCRIPTION_PLAN_PERIOD_TYPE_MONTHLY").
                setEnable("true").setName("zahra").setPrice(10000L).setUsageCountLimit(3L)
                //.setScVoucherHash(scVoucherHashs)
            .build();
    podSubscription.updateSubscriptionPlan(UpdateSubscriptionPlanVo, new OnGetResponseListener<SubscriptionPlanSrv>() {
        @Override
        public void onResponse(ResultVo<SubscriptionPlanSrv> result) {
            System.out.println(result.getResult().getPeriodTypeCode());
        }

        @Override
        public void onFailed(PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
    });
} catch (PodException e) {
    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
}

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/updateSubscriptionPlan</div>

# [PHP](#tab/php)

``` php

$param =
        [
        ## ============================= Required Parameters  ===============================
            "id" => {plan id}, 
        ## ============================= Optional Parameters  ===============================
            "periodTypeCode"=> "{put perido type code}", 
            "periodTypeCount"=> {put period type count},  
            "usageCountLimit"=> {put usage count limit}, 
            "usageAmountLimit"=> {put usage amount limit}, 
            "name"=>  "plan name", 
            "price"=> {put price},              
            "enable"=> "{true/false}",  
            'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
            'scApiKey'           => '{Put service call Api Key}',
    ];
    try {
        $result = $SubscriptionService->updateSubscriptionPlan($param);
        print_r($result);
    }
   catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
}

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/updateSubscriptionPlan</div>

# [Nodejs](#tab/nodejs)

``` javascript
let updateSubscriptionPlanData = {
  // ------ REQUIRED ------
  id: 0,

  // ------ OPTIONAL ------
  // periodTypeCode: 'SUBSCRIPTION_PLAN_PERIOD_TYPE_DAILY', // 'SUBSCRIPTION_PLAN_PERIOD_TYPE_YEARLY' | 'SUBSCRIPTION_PLAN_PERIOD_TYPE_MONTHLY' | 'SUBSCRIPTION_PLAN_PERIOD_TYPE_DAILY'
  // periodTypeCount: 0,
  // usageCountLimit: 0,
  // name: 'NAME2',
  // price: 0
  // enable: true
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiToken: 'SC API TOKEN'
};

podSubscription.updateSubscriptionPlan(updateSubscriptionPlanData)
  .then(function (result) {
    console.log('function: updateSubscriptionPlan ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error updateSubscriptionPlan ============>', error);
  });

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/updateSubscriptionPlan</div>

<div class="tab-end">
</div>

<div class="box-end">
</div>



## فعال سازی اشتراک برای کاربر

در فلوچارت زیر نحوه فعال سازی طرح اشتراک برای کاربر نمایش داده شده است.

<br/>

به صورت کلی مراحل به صورت زیر است :

- انتخاب طرح توسط کاربر
- ارسال درخواست فعال سازی طرح
- دریافت کد فعال سازی از کاربر و بررسی کد توسط سرویس confirmSubscription
  کاربر همچنین می توانید با ارسال کد فعال سازی به شماره ایی که کد از آن برایش ارسال شده به صورت خودکار طرح را فعال نماید
- و در مرحله آخر در هر بار مصرف (بسته به نوع نیاز کسب و کار شما) برای کاربر میزان مصرف ثبت شود.

<div class="mermaid">
graph TD  
A((شروع))  
A-.->B  
B(انتخاب طرح توسط کاربر)-.->C  
C(ارسال درخواست فعال سازی طرح برای کاربر)-.->D
D{آیا کد تاییدیه معتبر است}
D-- خیر ---E
E(نمایش خطا)
D-- بله ---F
F(فعال شدن طرح برای کاربر)-.->G
G(ثبت میزان مصرف برای کاربر)-.->M
M((پایان))
</div>

<div class="box-end">
</div>


## درخواست فعال سازی طرح اشتراک

توسط سرویس requestSubscription قادر خواهید بود طرح های اشتراکی که قبلا تعریف شده را ویرایش نمایید.


<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<SubscriptionSrv>();
            var requestSubscriptionVo = RequestSubscriptionVo.ConcreteBuilder
                                .SetServiceCallParameters(internalServiceCallVo)
                                .SetSubscriptionPlanId({Put your SubscriptionPlanId})
                                .SetUserId({Put your UserId})
                                .Build();
            subscriptionService.RequestSubscription(requestSubscriptionVo, response => Listener.GetResult(response, out output));
    }
    catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/requestSubscription</div>

# [Java](#tab/java)

``` java
//        List<String> scVoucherHashs =new ArrayList<>();
//        scVoucherHashs.add("RFSFGDYEDYGS");
  BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken(TOKEN)
                .setToken_issuer(1)
//                .setScApiKey("SDFJKSHFJwshfJshfDJH")
//                .setScVoucherHash(scVoucherHashs)
                .build();

        PodSubscription podSubscription = new PodSubscription();



        try {
            RequestSubscriptionVo requestSubscriptionVo = new RequestSubscriptionVo.Builder(baseInfoVo)
                    .setSubscriptionPlanId({subscriptionId})
                    .setUserId(L{userId})
                    .build();
            podSubscription.requestSubscription(requestSubscriptionVo, new OnGetResponseListener<SubscriptionSrv>() {
                @Override
                public void onResponse(ResultVo<SubscriptionSrv> result) {
                    System.out.println(result.getResult().getId());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/requestSubscription</div>

# [PHP](#tab/php)

``` php

    $param =
        [
        ## ============================== Required Parameters  ==============================
            "subscriptionPlanId" => {put subscription plan id},
            'userId'                => {put user id}, 
        ## ============================== Optional Parameters  ===============================
            'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
            'scApiKey'           => '{Put service call Api Key}',
        ];
    try {
        $result = $SubscriptionService->requestSubscription($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
}

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/requestSubscription</div>

# [Nodejs](#tab/nodejs)

``` javascript
let requestSubscriptionData = {
  // ------ REQUIRED ------
  subscriptionPlanId: 0,
  userId: 0

  // ------ OPTIONAL ------
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiToken: 'SC API TOKEN'
};

podSubscription.requestSubscription(requestSubscriptionData)
  .then(function (result) {
    console.log('function: requestSubscription ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error requestSubscription ============>', error);
  });

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/requestSubscription</div>

<div class="tab-end">
</div>




<div class="box-end">
</div>

## فعال سازی طرح اشتراک

توسط سرویس confirmSubscription و کد دریافتی از کاربر می توانید طرح اشتراک کاربر را فعال نمایید، و عملیات فعال سازی طرح اشتراک را کامل کنید.


<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<bool>();
            var confirmSubscriptionVo = ConfirmSubscriptionVo.ConcreteBuilder
                                .SetServiceCallParameters(internalServiceCallVo)
                                .SetCode("{Put your Code}")
                                .SetSubscriptionId({Put your SubscriptionId})
                                .Build();
            subscriptionService.ConfirmSubscription(confirmSubscriptionVo, response => Listener.GetResult(response, out output));
    }
    catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/confirmSubscription</div>

# [Java](#tab/java)

``` java
//        List<String> scVoucherHashs =new ArrayList<>();
//        scVoucherHashs.add("RFSFGDYEDYGS");
 BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken(TOKEN)
                .setToken_issuer(1)
//                .setScApiKey("SDFJKSHFJwshfJshfDJH")
//                .setScVoucherHash(scVoucherHashs)
                .build();

        PodSubscription podSubscription = new PodSubscription();



        try {
            ConfirmSubscriptionVo confirmSubscriptionVo = new ConfirmSubscriptionVo.Builder(baseInfoVo)
                    .setSubscriptionId({subscriptionId})
                    .setCode({code})
                    .build();
            podSubscription.confirmSubscription(confirmSubscriptionVo, new OnGetResponseListener<SubscriptionSrv>() {
                @Override
                public void onResponse(ResultVo<SubscriptionSrv> result) {
                    System.out.println(result.getResult());
                }

                @Override
                public void onFailed(PodException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
    }

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/confirmSubscription</div>

# [PHP](#tab/php)

``` php

$param =
        [
        ## ========================= Required Parameters  ==================================
            "subscriptionId" => {put subscription id}, 
            'code'            => {put code},  
        ## ========================= Optional Parameters  ===================================
            'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
            'scApiKey'           => '{Put service call Api Key}',
        ];
    try {
        $result = $SubscriptionService->confirmSubscription($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
}

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/confirmSubscription</div>

# [Nodejs](#tab/nodejs)

``` javascript
let confirmSubscriptionData = {
  // ------ REQUIRED ------
  subscriptionId: 0,
  code: 'CODE'

  // ------ OPTIONAL ------
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiToken: 'SC API TOKEN'
};

podSubscription.confirmSubscription(confirmSubscriptionData)
  .then(function (result) {
    console.log('function: confirmSubscription ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error confirmSubscription ============>', error);
  });

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/confirmSubscription</div>

<div class="tab-end">
</div>




<div class="box-end">
</div>


## لیست اشتراک ها
کاربر یا کسب و کار به ازای هربار فعال کردن و استفاده از طرح برایش لیستی از طرح ها ایجاد خواهد شد که توسط سرویس زیر قابل دریافت میباشد


<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<List<SubscriptionFullSrv>>();
            var subscriptionListVo = SubscriptionListVo.ConcreteBuilder
                                .SetServiceCallParameters(internalServiceCallVo)
                                .SetOffset({Put your Offset})
                                .SetSize({Put your Size})
                                .SetSubscriptionPlanId({Put your SubscriptionPlanId})
                                .Build();
            subscriptionService.SubscriptionList(subscriptionListVo, response => Listener.GetResult(response, out output));
    }
    catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/subscriptionList</div>

# [Java](#tab/java)

``` java
//        List<String> scVoucherHashs =new ArrayList<>();
//        scVoucherHashs.add("RFSFGDYEDYGS");
 BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
//                .setScApiKey("SDFJKSHFJwshfJshfDJH")
//                .setScVoucherHash(scVoucherHashs)
                .build();

        PodSubscription podSubscription = new PodSubscription();



        try {
            SubscriptionListVo subscriptionListVo = new SubscriptionListVo.Builder(baseInfoVo)
                    .setOffset({offset})
                    .setSize(100L)
                    .setSubscriptionPlanId({subscriptionPlanId})
                    .build();
            podSubscription.subscriptionList(subscriptionListVo, new OnGetResponseListener<List<SubscriptionFullSrv>>() {
                @Override
                public void onResponse(ResultVo<List<SubscriptionFullSrv>> result) {
                    System.out.println(result.getResult().size());
                }

                @Override
                public void onFailed(PodSubscriptionException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodSubscriptionException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/subscriptionList</div>

# [PHP](#tab/php)

``` php

  $param =
        [
        ## ============================ Required Parameters  ===================================
            "offset" => {put offset},
            "size"   => {put size},
            "subscriptionPlanId" => {put subscription plan id},
        ## ============================ Optional Parameters  ====================================
            'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
            'scApiKey'           => '{Put service call Api Key}',
        ];
    try {
        $result = $SubscriptionService->subscriptionList($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
}

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/subscriptionList</div>

# [Nodejs](#tab/nodejs)

``` javascript
let subscriptionListData = {
  // ------ REQUIRED ------
  subscriptionPlanId: 124,
  offset: 0,
  size: 10

  // ------ OPTIONAL ------
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiToken: 'SC API TOKEN'
};

podSubscription.subscriptionList(subscriptionListData)
  .then(function (result) {
    console.log('function: subscriptionList ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error subscriptionList ============>', error);
  });

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/subscriptionList</div>

<div class="tab-end">
</div>

<div class="box-end">
</div>

## ثبت میزان مصرف
توسط سرویس consumeSubscription قادر خواهید بود میزان مصرف خود از طرح های انتخاب شده و درحال استفاده را مشاهده نمایید.


<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<SubscriptionSrv>();
            var consumeSubscriptionVo = ConsumeSubscriptionVo.ConcreteBuilder
                                .SetServiceCallParameters(internalServiceCallVo)
                                .SetId({Put your Id})
                                //.SetUsedAmount({Put your UsedAmount})
                                .Build();
            subscriptionService.ConsumeSubscription(consumeSubscriptionVo, response => Listener.GetResult(response, out output));
    }
    catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/consumeSubscription</div>

# [Java](#tab/java)

``` java
//        List<String> scVoucherHashs =new ArrayList<>();
//        scVoucherHashs.add("RFSFGDYEDYGS");
 BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
//                .setScApiKey("SDFJKSHFJwshfJshfDJH")
//                .setScVoucherHash(scVoucherHashs)
                .build();

        PodSubscription billingService = new PodSubscription();



        try {
            ConsumeSubscriptionVo ConsumeSubscriptionVo = new ConsumeSubscriptionVo.Builder(baseInfoVo)
                    .setId({id})
                    .setUsedAmount({usedAmount})
                    .build();
            billingService.consumeSubscription(ConsumeSubscriptionVo, new OnGetResponseListener<SubscriptionSrv>() {
                @Override
                public void onResponse(ResultVo<SubscriptionSrv> result) {
                    System.out.println(result.getResult().getId());
                }

                @Override
                public void onFailed(PodSubscriptionException e) {
                    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
                }
            });
        } catch (PodSubscriptionException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/consumeSubscription</div>

# [PHP](#tab/php)

``` php

$param =
        [
        ## ============================ Required Parameters  =================================
            'id'    => {put subscription plan id}, 
        ## ============================ Optional Parameters  ==================================
            "usedAmount" => {used amount}, 
            'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
            'scApiKey'           => '{Put service call Api Key}',
        ];
    try {
        $result = $SubscriptionService->consumeSubscription($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
}

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/consumeSubscription</div>

# [Nodejs](#tab/nodejs)

``` javascript
let consumeSubscriptionData = {
  // ------ REQUIRED ------
  id: 10,
  usedAmount: 100

  // ------ OPTIONAL ------
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiToken: 'SC API TOKEN'
};

podSubscription.consumeSubscription(consumeSubscriptionData)
  .then(function (result) {
    console.log('function: consumeSubscription ============>', result, '\n');
  })
  .catch(function (error) {
    console.log('error consumeSubscription ============>', error);
  });

```
<div class="swaggerLink">http://sandbox.pod.land:8080/apidocs/swagger-ui.html?srv=/nzh/biz/consumeSubscription</div>

<div class="tab-end">
</div>




<div class="box-end">
</div>

## لینک‌های مرتبط

- [مقدمه](/app/documents/introduction/)
- [مفاهیم](/app/documents/concepts/)
- [استاندارد و خطاها](/app/documents/errors/)
- [شروع به کار](/app/documents/get-started/)
- [پکیج‌ها](/app/documents/packages/)

<div class="box-end">
</div>

